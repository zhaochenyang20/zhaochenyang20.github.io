<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>oopç¬”è®°  L6  å¼•ç”¨ä¸å¤åˆ¶ | I'LL TAKE YOU TO THE MOON</title><meta name="keywords" content="è·ªç³»çš„æ™®é€šå­¦ç”Ÿ"><meta name="author" content="Eren Zhao"><meta name="copyright" content="Eren Zhao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–...">
<meta property="og:type" content="article">
<meta property="og:title" content="oopç¬”è®°  L6  å¼•ç”¨ä¸å¤åˆ¶">
<meta property="og:url" content="http://example.com/2022/01/12/Lecture/%E4%BB%8E%E5%89%8D%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/OOP/L6%20%E5%BC%95%E7%94%A8%E4%B8%8E%E5%A4%8D%E5%88%B6/index.html">
<meta property="og:site_name" content="I&#39;LL TAKE YOU TO THE MOON">
<meta property="og:description" content="ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–...">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/zhaochenyang20/ivue_wallpaper/main/ivue_desktop/Photo by eberhard ğŸ– grossgasteiger (v37iUOL2e8U).jpg">
<meta property="article:published_time" content="2022-01-12T08:33:22.000Z">
<meta property="article:modified_time" content="2022-08-26T15:38:26.139Z">
<meta property="article:author" content="Eren Zhao">
<meta property="article:tag" content="è·ªç³»çš„æ™®é€šå­¦ç”Ÿ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/zhaochenyang20/ivue_wallpaper/main/ivue_desktop/Photo by eberhard ğŸ– grossgasteiger (v37iUOL2e8U).jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/2022/01/12/Lecture/%E4%BB%8E%E5%89%8D%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/OOP/L6%20%E5%BC%95%E7%94%A8%E4%B8%8E%E5%A4%8D%E5%88%B6/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"éº»äº†ï¼Œæ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'oopç¬”è®°  L6  å¼•ç”¨ä¸å¤åˆ¶',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2022-08-26 23:38:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/mouse.css"><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="I'LL TAKE YOU TO THE MOON" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}</style></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend.jpg'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">193</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">52</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">31</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/list-100/"><i class="fa-fw fas fa-music"></i><span> TODO</span></a></div><div class="menus_item"><a class="site-page" href="/projects/"><i class="fa-fw fas fa-video"></i><span> Projects</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/zhaochenyang20/ivue_wallpaper/main/ivue_desktop/Photo by eberhard ğŸ– grossgasteiger (v37iUOL2e8U).jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">I'LL TAKE YOU TO THE MOON</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/list-100/"><i class="fa-fw fas fa-music"></i><span> TODO</span></a></div><div class="menus_item"><a class="site-page" href="/projects/"><i class="fa-fw fas fa-video"></i><span> Projects</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">oopç¬”è®°  L6  å¼•ç”¨ä¸å¤åˆ¶</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-01-12T08:33:22.000Z" title="å‘è¡¨äº 2022-01-12 16:33:22">2022-01-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-08-26T15:38:26.139Z" title="æ›´æ–°äº 2022-08-26 23:38:26">2022-08-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E7%A8%8B/">è¯¾ç¨‹</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E7%A8%8B/OOP/">OOP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">11.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>45åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="oopç¬”è®°  L6  å¼•ç”¨ä¸å¤åˆ¶"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="L6-å¼•ç”¨ä¸å¤åˆ¶"><a href="#L6-å¼•ç”¨ä¸å¤åˆ¶" class="headerlink" title="L6 å¼•ç”¨ä¸å¤åˆ¶"></a>L6 å¼•ç”¨ä¸å¤åˆ¶</h1><blockquote>
<p>å¦‚æœé˜…è¯»æ—¶é—´ä¸å¤Ÿå……è¶³ï¼Œå»ºè®®é˜…è¯»è¯¾å ‚çš„æ‰©å±•éƒ¨åˆ†ã€‚</p>
<ul>
<li>2.4.2 é»˜è®¤ç”Ÿæˆç§»åŠ¨æ„é€ å‡½æ•°</li>
<li>3.2.3 ä¾‹äºŒï¼šå®Œæ•´å®šä¹‰æ‰€æœ‰å‡½æ•°ä½†ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–åçš„æ‰§è¡Œé¡ºåº</li>
<li>ç»“åˆç¬¬ä¸‰æ¬¡ä½œä¸šç¬¬äºŒé¢˜è®¨è®ºè¿”å›å€¼ä¼˜åŒ–</li>
<li>ç»“åˆç¬¬ä¸‰æ¬¡ä½œä¸šç¬¬ä¸‰é¢˜è®¨è®ºdeleteä¸æ£€æµ‹</li>
<li>ç»“åˆç¬¬ä¸‰æ¬¡ä½œä¸šç¬¬ä¸‰é¢˜è®¨è®ºmoveä¸ç±»å‹è½¬æ¢</li>
<li>ç»“åˆç¬¬ä¸‰æ¬¡ä½œä¸šç¬¬ä¸‰é¢˜è®¨è®ºç½®ç©ºæ“ä½œ</li>
<li>9.3 ç±»å‹è½¬æ¢çš„å®ä¾‹è¯¦è¿°</li>
</ul>
</blockquote>
<hr>
<h1 id="ä¸€ã€å¸¸é‡å¼•ç”¨"><a href="#ä¸€ã€å¸¸é‡å¼•ç”¨" class="headerlink" title="ä¸€ã€å¸¸é‡å¼•ç”¨"></a>ä¸€ã€å¸¸é‡å¼•ç”¨</h1><h2 id="1-1-å¸¸é‡å¼•ç”¨çš„æ„ä¹‰"><a href="#1-1-å¸¸é‡å¼•ç”¨çš„æ„ä¹‰" class="headerlink" title="1.1  å¸¸é‡å¼•ç”¨çš„æ„ä¹‰"></a>1.1  å¸¸é‡å¼•ç”¨çš„æ„ä¹‰</h2><p>æŒ‰ç…§æœ€å°ç‰¹æƒåŸåˆ™ï¼šç»™å‡½æ•°è¶³å¤Ÿçš„æƒé™å»å®Œæˆç›¸åº”çš„ä»»åŠ¡ï¼Œä½†ä¸è¦ç»™äºˆä»–ä»»ä½•å¤šä½™çš„æƒé™ã€‚ä¾‹å¦‚å‡½æ•°void add(int&amp; a, int&amp; b)ï¼Œå¦‚æœå°†å‚æ•°ç±»å‹å®šä¹‰ä¸ºint&amp;ï¼Œåˆ™ç»™äºˆè¯¥å‡½æ•°åœ¨å‡½æ•°ä½“å†…ä¿®æ”¹aå’Œbçš„å€¼çš„æƒé™ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬ä¸æƒ³ç»™äºˆå‡½æ•°ä¿®æ”¹æƒé™ï¼Œåˆ™å¯ä»¥åœ¨å‚æ•°ä¸­ä½¿ç”¨å¸¸é‡/å¸¸é‡å¼•ç”¨<code>void add(const int&amp; a, const int&amp; b)</code>ã€‚æ­¤æ—¶å‡½æ•°ä¸­ä»…èƒ½è¯»å–aå’Œbçš„å€¼ï¼Œæ— æ³•å¯¹a, bè¿›è¡Œä»»ä½•ä¿®æ”¹æ“ä½œã€‚</p>
<h1 id="äºŒã€æ‹·è´æ„é€ å‡½æ•°"><a href="#äºŒã€æ‹·è´æ„é€ å‡½æ•°" class="headerlink" title="äºŒã€æ‹·è´æ„é€ å‡½æ•°"></a>äºŒã€æ‹·è´æ„é€ å‡½æ•°</h1><h2 id="2-1-å®šä¹‰ä¸è¯­æ³•è§„åˆ™"><a href="#2-1-å®šä¹‰ä¸è¯­æ³•è§„åˆ™" class="headerlink" title="2.1  å®šä¹‰ä¸è¯­æ³•è§„åˆ™"></a>2.1  å®šä¹‰ä¸è¯­æ³•è§„åˆ™</h2><p>æ‹·è´æ„é€ å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ„é€ å‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯è¯­è¨€è§„å®šçš„ï¼Œæ˜¯åŒç±»å¯¹è±¡çš„å¸¸é‡å¼•ç”¨ã€‚<br>ä½œç”¨ï¼šç”¨å‚æ•°å¯¹è±¡çš„å†…å®¹åˆå§‹åŒ–å½“å‰å¯¹è±¡ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">Vector::<span class="built_in">Vector</span>(<span class="keyword">const</span>Â Vector&amp;Â other)</span><br><span class="line">&#123;</span><br><span class="line">Â Â Â Â capacityÂ =Â other.capacity;</span><br><span class="line">Â Â Â Â lenÂ =Â other.len;</span><br><span class="line">Â Â Â Â arrayÂ =Â <span class="keyword">new</span>Â Node[other.capacity];</span><br><span class="line">Â Â Â Â <span class="keyword">for</span>Â (<span class="keyword">int</span>Â iÂ =Â <span class="number">0</span>;Â iÂ &lt;Â len;Â i++)</span><br><span class="line">Â Â Â Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â array[i]Â =other.array[i];</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-2-è°ƒç”¨æ—¶æœº"><a href="#2-2-è°ƒç”¨æ—¶æœº" class="headerlink" title="2.2  è°ƒç”¨æ—¶æœº"></a>2.2  è°ƒç”¨æ—¶æœº</h2><p>æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨çš„ä¸‰ç§å¸¸è§æƒ…å†µã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è°ƒç”¨â€œæ‹·è´æ„é€ å‡½æ•°â€ï¼Œåœ¨å·²æœ‰å¯¹è±¡åŸºç¡€ä¸Šç”Ÿæˆæ–°å¯¹è±¡ã€‚</p>
<p>ç”¨ä¸€ä¸ªç±»å¯¹è±¡å®šä¹‰å¦ä¸€ä¸ªæ–°çš„ç±»å¯¹è±¡ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">Test a;<span class="function">Test <span class="title">b</span><span class="params">(a)</span></span>;</span><br><span class="line">Test c=a;</span><br></pre></td></tr></table></figure>
<p>å‡½æ•°è°ƒç”¨æ—¶ä»¥ç±»çš„å¯¹è±¡ä¸ºå½¢å‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Func</span>(Test a)</span><br></pre></td></tr></table></figure>
<p>å‡½æ•°è¿”å›ç±»å¯¹è±¡ï¼ˆæ— è¿”å›å€¼ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">Test <span class="title">Func</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br></pre></td></tr></table></figure>
<h2 id="2-3-éšå¼æ‹·è´æ„é€ å‡½æ•°"><a href="#2-3-éšå¼æ‹·è´æ„é€ å‡½æ•°" class="headerlink" title="2.3  éšå¼æ‹·è´æ„é€ å‡½æ•°"></a>2.3  éšå¼æ‹·è´æ„é€ å‡½æ•°</h2><p>ç±»çš„æ–°å¯¹è±¡è¢«å®šä¹‰åï¼Œä¼šè°ƒç”¨æ„é€ å‡½æ•°æˆ–æ‹·è´æ„é€ å‡½æ•°ã€‚å¦‚æœè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ä¸”å½“å‰æ²¡æœ‰ç»™ç±»æ˜¾å¼å®šä¹‰æ‹·è´æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨å°†è‡ªåŠ¨åˆæˆâ€œéšå¼å®šä¹‰çš„æ‹·è´æ„é€ å‡½æ•°â€ï¼Œå…¶åŠŸèƒ½æ˜¯è°ƒç”¨æ‰€æœ‰æ•°æ®æˆå‘˜çš„æ‹·è´æ„é€ å‡½æ•°æˆ–æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ã€‚</p>
<p>å¯¹äºåŸºç¡€ç±»å‹æ¥è¯´ï¼Œé»˜è®¤çš„æ‹·è´æ–¹å¼ä¸ºä½æ‹·è´(Bitwise Copy)ï¼Œå³ç›´æ¥å¯¹æ•´å—å†…å­˜è¿›è¡Œå¤åˆ¶ã€‚</p>
<p>ä½æ‹·è´åŸæœ¬æ˜¯Cä¸­çš„æ¦‚å¿µã€‚åœ¨C++ä¸­ï¼Œåªæœ‰åŸºç¡€ç±»å‹ï¼ˆint, doubleç­‰ï¼‰æ‰ä¼šè¿›è¡Œä½æ‹·è´ï¼›å¯¹äºè‡ªå®šä¹‰ç±»ï¼Œç¼–è¯‘å™¨ä¼šé€’å½’è°ƒç”¨æ‰€æœ‰æ•°æ®æˆå‘˜çš„æ‹·è´æ„é€ å‡½æ•°æˆ–æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ã€‚ä½†ä¸€äº›æ•™æä¸­ä»ç„¶æŠŠè¿™ç§è¡Œä¸ºç§°ä¸ºâ€œä½æ‹·è´â€ï¼Œä»¥åŒºåˆ«ç”¨æˆ·è‡ªå®šä¹‰çš„æ‹·è´æ–¹æ³•ã€‚</p>
<p>éšå¼å®šä¹‰æ‹·è´æ„é€ å‡½æ•°çš„ç¼ºé™·ï¼šéšå¼å®šä¹‰æ‹·è´æ„é€ å‡½æ•°åœ¨é‡åˆ°æŒ‡é’ˆç±»å‹æˆå‘˜æ—¶å¯èƒ½ä¼šå‡ºé”™,å¯¼è‡´å¤šä¸ªæŒ‡é’ˆç±»å‹çš„å˜é‡æŒ‡å‘åŒä¸€ä¸ªåœ°å€ã€‚</p>
<h2 id="2-4-æ‰§è¡Œé¡ºåº"><a href="#2-4-æ‰§è¡Œé¡ºåº" class="headerlink" title="2.4  æ‰§è¡Œé¡ºåº"></a>2.4  æ‰§è¡Œé¡ºåº</h2><h3 id="2-4-1-åŸºæœ¬çš„æ‰§è¡Œé¡ºåº"><a href="#2-4-1-åŸºæœ¬çš„æ‰§è¡Œé¡ºåº" class="headerlink" title="2.4.1  åŸºæœ¬çš„æ‰§è¡Œé¡ºåº"></a>2.4.1  åŸºæœ¬çš„æ‰§è¡Œé¡ºåº</h3><p>ä»¥ä¸‹è¿°çš„funcå‡½æ•°ä¸ºä¾‹ï¼Œè°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå‡½æ•°ä¸­å„ç±»æ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„æ‰§è¡Œé¡ºåºå¦‚ä¸‹ã€‚</p>
<p><img src="https://s2.loli.net/2022/01/11/zNMXaWyvsr35Gb7.png" alt="https://s2.loli.net/2022/01/11/zNMXaWyvsr35Gb7.png"></p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå®é™…ä¸Šåœ¨ä¸»å‡½æ•°ä½“å†…ï¼Œå‡è®¾æˆ‘ä»¬ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–ã€‚<code>Myclass a= func(d);</code>è¿™ä¸ªè¯­å¥å†…çš„è¿”å›å€¼ç±»æ„é€ è°ƒç”¨äº†æ‹·è´æ„é€ ï¼Œå¹¶ä¸”ç›¸å…³çš„ææ„éå¸¸å€¼å¾—ç ”ç©¶ï¼Œä¸‹æ–‡å°†åœ¨ç§»åŠ¨æ„é€ å‡½æ•°çš„ä¾‹å­ä¸­å°†è¿›ä¸€æ­¥é˜è¿°ã€‚</p>
<h3 id="2-4-2-ä¾‹å­"><a href="#2-4-2-ä¾‹å­" class="headerlink" title="2.4.2  ä¾‹å­"></a>2.4.2  ä¾‹å­</h3><p>ï¼ˆç¼–è¯‘æŒ‡ä»¤g++ test.cpp â€”std=c++11 -fno-elide-constructors â€“o testï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Test</span>Â &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>()Â &#123;Â <span class="comment">//æ„é€ å‡½æ•°</span></span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Test()&quot;</span>Â &lt;&lt;Â endl;Â </span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;Â src)Â &#123;Â <span class="comment">//æ‹·è´æ„é€ </span></span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Test(constÂ Test&amp;)&quot;</span>Â &lt;&lt;Â endl;Â </span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â ~<span class="built_in">Test</span>()Â &#123;Â <span class="comment">//ææ„å‡½æ•°</span></span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;~Test()&quot;</span>Â &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">TestÂ <span class="title">copyObj</span><span class="params">(TestÂ obj)</span>Â </span>&#123;Â </span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;func()...&quot;</span>Â &lt;&lt;Â endl;Â </span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="built_in">Test</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;main()...&quot;</span>Â &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â TestÂ t;</span><br><span class="line">Â Â Â Â tÂ =Â <span class="built_in">copyObj</span>(t);</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line"><span class="built_in">main</span>()...</span><br><span class="line"><span class="built_in">Test</span>()Â Â <span class="comment">//mainå‡½æ•°å†…åˆå§‹åŒ–Â Test</span></span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;)<span class="comment">//funcå‚æ•°Â æ‹·è´æ„é€ </span></span><br><span class="line"><span class="built_in">func</span>()...</span><br><span class="line"><span class="built_in">Test</span>()Â Â Â <span class="comment">//åˆå§‹åŒ–Â Testç±»çš„å¯¹è±¡</span></span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;)Â <span class="comment">//è¿”å›æ—¶æ‹·è´æ„é€ </span></span><br><span class="line">~<span class="built_in">Test</span>()</span><br><span class="line">~<span class="built_in">Test</span>()</span><br><span class="line">~<span class="built_in">Test</span>()</span><br><span class="line">~<span class="built_in">Test</span>()</span><br></pre></td></tr></table></figure>
<p>å¯¹åº”å…³ç³»å¹¶ä¸å¤æ‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://s2.loli.net/2022/01/11/KPIF2NO1WwmTDhS.png" alt="https://s2.loli.net/2022/01/11/KPIF2NO1WwmTDhS.png"></p>
<p>å…¶å®æœ€æœ‰æ„æ€çš„æ˜¯ï¼Œè¿™é‡Œå¯¹äºè¿”å›ç±»å¯¹è±¡çš„æ„é€ ã€‚</p>
<p>æˆ‘ä»¬åœ¨ç¬¬ä¸‰æ¬¡ä½œä¸šç¬¬äºŒé¢˜å½“ä¸­å­¦ä¹ è¿‡ï¼š</p>
<blockquote>
<p>â€œåœ¨ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–çš„æ¡ä»¶ä¸‹ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯æŸä¸ªå¯¹è±¡ï¼Œé‚£åœ¨å‡½æ•°è¿”å›å‰éœ€è¦è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°æ„å»ºè¿”å›å€¼ã€‚</p>
</blockquote>
<p>å³ä½¿æˆ‘è¿”å›çš„ä¸œè¥¿å°±æ˜¯æˆ‘ä¼ è¿›æ¥çš„å½¢å‚å¯¹è±¡ï¼Œè¿”å›å‰çš„è¿™æ¬¡æ„é€ ä»ç„¶ä¼šå‘ç”Ÿï¼Œä¹Ÿå°±æ˜¯è¿™é“é¢˜ä¸­f1çš„ç¬¬äºŒæ¬¡æ„é€ å‡½æ•°è°ƒç”¨ã€‚</p>
<p>ä½†æ˜¯å¯¹äºè¿”å›å€¼çš„æ„é€ è°ƒç”¨çš„åˆ°åº•æ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œè¿˜æ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Œå¯¹æ­¤C++11æœ‰è§„å®šï¼šåœ¨æ— è¿”å›å€¼ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ã€‚â€</p>
<p>æŒ‰æ­¤ç†è§£ï¼Œæ­¤å¤„æ„é€ è¿”å›å€¼ç†åº”è°ƒç”¨ç§»åŠ¨æ„é€ ï¼Œè€Œéæ‹·è´æ„é€ ï¼Œä¼¼ä¹äº§ç”Ÿäº†çŸ›ç›¾ã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬æ˜¾å¼å®šä¹‰äº†æ‹·è´æ„é€ ï¼Œç¼–è¯‘å™¨å°±ä¸ä¼šé»˜è®¤ç”Ÿæˆç§»åŠ¨æ„é€ äº†ã€‚ä»è€Œç¦ç”¨äº†è¿”å›å€¼ä¼˜åŒ–åï¼Œåœ¨è¿”å›å€¼çš„æ„é€ å½“ä¸­è°ƒç”¨äº†æ‹·è´æ„é€ è€Œéç§»åŠ¨æ„é€ ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¸ä¼šé»˜è®¤ç”Ÿæˆç§»åŠ¨æ„é€ ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰è‡ªå·±å®šä¹‰ã€‚</p>
<p>æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœæˆ‘æ˜¾å¼å®šä¹‰äº†æ‹·è´èµ‹å€¼ï¼Œå°±ä¸ä¼šé»˜è®¤ç”Ÿæˆç§»åŠ¨èµ‹å€¼äº†ã€‚å¦‚æœä¸¤ä¸ªéƒ½ä¸å®šä¹‰ï¼Œä¸¤ä¸ªéƒ½ä¼šé»˜è®¤ç”Ÿæˆã€‚</p>
<h2 id="2-5-æ‹·è´æ„é€ å‡½æ•°çš„ç¼ºé™·"><a href="#2-5-æ‹·è´æ„é€ å‡½æ•°çš„ç¼ºé™·" class="headerlink" title="2.5  æ‹·è´æ„é€ å‡½æ•°çš„ç¼ºé™·"></a>2.5  æ‹·è´æ„é€ å‡½æ•°çš„ç¼ºé™·</h2><p>å½“ç±»å†…å«æŒ‡é’ˆç±»å‹çš„æˆå‘˜æ—¶ï¼Œæ‹·è´æ„é€ å‡½æ•°ä¼šä½¿å¾—ä¸¤ä¸ªæŒ‡æ­£æŒ‡å‘åŒä¸€å†…å­˜ç©ºé—´ã€‚åœ¨ææ„æ—¶ï¼Œè¯¥å†…å­˜ç©ºé—´å¯èƒ½è¢«åå¤é‡Šæ”¾ã€‚ä¸ºé¿å…æŒ‡é’ˆè¢«é‡å¤åˆ é™¤ï¼Œä¸åº”ä½¿ç”¨éšå¼å®šä¹‰çš„æ‹·è´æ„é€ å‡½æ•°ã€‚</p>
<p>ä»¥åŠï¼Œå½“<strong>å¯¹è±¡è¾ƒå¤§</strong>æ—¶ï¼Œé¢‘ç¹çš„æ‹·è´æ„é€ ä¼šé€ æˆç¨‹åº<strong>æ•ˆç‡çš„æ˜¾è‘—ä¸‹é™</strong>ã€‚</p>
<p>æ•…è€Œï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œåº”å°½å¯èƒ½é¿å…ä½¿ç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚</p>
<h2 id="2-6-è§£å†³æ–¹æ³•"><a href="#2-6-è§£å†³æ–¹æ³•" class="headerlink" title="2.6  è§£å†³æ–¹æ³•"></a>2.6  è§£å†³æ–¹æ³•</h2><ul>
<li>ä½¿ç”¨å¼•ç”¨/å¸¸é‡å¼•ç”¨ä¼ å‚æ•°æˆ–è¿”å›å¯¹è±¡ï¼›</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">å¼•ç”¨æˆ–å¸¸é‡å¼•ç”¨ä¼ é€’å‚æ•°</span><br><span class="line"><span class="built_in">func</span>(MyClassÂ a)æ”¹ä¸º<span class="built_in">func</span>(<span class="keyword">const</span>Â MyClass&amp;Â a)</span><br><span class="line">è¿”å›å€¼ä¸ºå¼•ç”¨</span><br><span class="line"><span class="function">MyClassÂ <span class="title">func</span><span class="params">(â€¦)</span>æ”¹ä¸ºMyClass&amp;Â <span class="title">func</span><span class="params">(â€¦)</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>å°†æ‹·è´æ„é€ å‡½æ•°å£°æ˜ä¸ºprivateï¼›</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">MyClass</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">Â Â <span class="built_in">MyClass</span>(<span class="keyword">const</span>Â MyClass&amp;)&#123;&#125;</span><br><span class="line">Â Â <span class="keyword">public</span>:</span><br><span class="line">Â Â Â Â <span class="built_in">MyClass</span>()=<span class="keyword">default</span>;</span><br><span class="line">Â Â Â Â Â Â ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç”¨deleteå…³é”®å­—è®©ç¼–è¯‘å™¨ä¸ç”Ÿæˆæ‹·è´æ„é€ å‡½æ•°çš„éšå¼å®šä¹‰ç‰ˆæœ¬ã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">MyClass</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">Â Â <span class="keyword">public</span>:</span><br><span class="line">Â Â Â Â <span class="built_in">MyClass</span>()=<span class="keyword">default</span>;</span><br><span class="line">Â Â Â Â <span class="built_in">MyClass</span>(<span class="keyword">const</span>Â MyClass&amp;)=<span class="keyword">delete</span>;</span><br><span class="line">Â Â ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ä¸‰ã€ç§»åŠ¨æ„é€ å‡½æ•°"><a href="#ä¸‰ã€ç§»åŠ¨æ„é€ å‡½æ•°" class="headerlink" title="ä¸‰ã€ç§»åŠ¨æ„é€ å‡½æ•°"></a>ä¸‰ã€ç§»åŠ¨æ„é€ å‡½æ•°</h1><h2 id="3-1-å³å€¼ä¸å³å€¼å¼•ç”¨"><a href="#3-1-å³å€¼ä¸å³å€¼å¼•ç”¨" class="headerlink" title="3.1  å³å€¼ä¸å³å€¼å¼•ç”¨"></a>3.1  å³å€¼ä¸å³å€¼å¼•ç”¨</h2><h3 id="3-1-1-å·¦å³å€¼"><a href="#3-1-1-å·¦å³å€¼" class="headerlink" title="3.1.1  å·¦å³å€¼"></a>3.1.1  å·¦å³å€¼</h3><p>å·¦å€¼ï¼šå¯ä»¥å–åœ°å€ã€æœ‰åå­—çš„å€¼ã€‚<br>å³å€¼ï¼šä¸èƒ½å–åœ°å€ã€æ²¡æœ‰åå­—çš„å€¼;å¸¸è§äºå¸¸å€¼ã€å‡½æ•°è¿”å›å€¼ã€è¡¨è¾¾å¼ã€‚<br>è™½ç„¶å³å€¼ä¸èƒ½å–åœ°å€ä¹Ÿæ²¡æœ‰åå­—ï¼Œä½†æ˜¯å³å€¼å¯ä»¥è¿ç®—ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span>Â aÂ =Â <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span>Â bÂ =Â <span class="built_in">func</span>();</span><br><span class="line"><span class="keyword">int</span>Â cÂ =Â aÂ +Â b;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­aã€bã€cä¸ºå·¦å€¼ï¼Œ1ã€funcå‡½æ•°è¿”å›å€¼ã€a+bçš„ç»“æœä¸ºå³å€¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">x</span><span class="params">()</span></span>;</span><br><span class="line">Â <span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â &amp;&amp;a=<span class="built_in">x</span>()+<span class="number">1</span>;</span><br><span class="line">Â Â Â Â cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">Â Â Â Â a++;</span><br><span class="line">Â Â Â Â cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">x</span><span class="params">()</span></span>&#123;<span class="keyword">return</span>Â <span class="number">1</span>;&#125;</span><br><span class="line">Outputï¼š</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>å³å€¼å¯ä»¥è¿ç®—ï¼Œä¸”å³å€¼å¼•ç”¨æ¥æ”¶å³å€¼åä¹Ÿå¯ä»¥è¿ç®—ã€‚</p>
<p>å·¦å€¼å¯ä»¥å–åœ°å€ï¼Œå¹¶ä¸”å¯ä»¥è¢«&amp;å¼•ç”¨(å·¦å€¼å¼•ç”¨)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span>Â *dÂ =Â &amp;a;Â Â <span class="keyword">int</span>Â &amp;dÂ =Â a;<span class="comment">//å…è®¸</span></span><br><span class="line"><span class="keyword">int</span>Â *eÂ =Â &amp;(aÂ +Â b);Â <span class="keyword">int</span>Â &amp;eÂ =Â aÂ +Â b;Â <span class="comment">//éæ³•</span></span><br></pre></td></tr></table></figure>
<h3 id="3-1-2-å³å€¼å¼•ç”¨"><a href="#3-1-2-å³å€¼å¼•ç”¨" class="headerlink" title="3.1.2  å³å€¼å¼•ç”¨"></a>3.1.2  å³å€¼å¼•ç”¨</h3><p>è™½ç„¶å³å€¼æ— æ³•å–åœ°å€ï¼Œä½†å¯ä»¥è¢«&amp;&amp;å¼•ç”¨(å³å€¼å¼•ç”¨)</p>
<p>å³å€¼å¼•ç”¨å¯ä»¥ç»‘å®šå³å€¼ï¼š<code>int &amp;&amp;e = a+b;</code></p>
<p>å³å€¼å¼•ç”¨æ— æ³•ç»‘å®šå·¦å€¼ï¼š<code>int &amp;&amp;e=a;//è¯¥æ“ä½œéæ³•</code></p>
<p>æ€»ä¹‹ï¼Œå·¦å€¼å¼•ç”¨èƒ½ç»‘å®šå·¦å€¼ï¼Œå³å€¼å¼•ç”¨èƒ½ç»‘å®šå³å€¼ã€‚ç‰¹ä¾‹ï¼š<strong>å¸¸é‡å·¦å€¼å¼•ç”¨èƒ½ä¹Ÿç»‘å®šå³å€¼</strong>ï¼Œå› ä¸ºå¸¸é‡å·¦å€¼å¼•ç”¨ä¸ä¼šæ”¹å˜å†…å­˜ç©ºé—´çš„æ•°æ®ï¼Œæ•…è€Œä¸ä¼šå½±å“å³å€¼ã€‚ä¹Ÿå¯ä»¥å®ç°ç»‘å®šã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span>Â <span class="keyword">int</span>Â &amp;eÂ =Â <span class="number">3</span>;Â </span><br><span class="line"><span class="keyword">const</span>Â <span class="keyword">int</span>Â &amp;eÂ =Â a*b;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°ï¼Œæ‰€æœ‰çš„å¼•ç”¨ï¼ˆåŒ…æ‹¬å³å€¼å¼•ç”¨ï¼‰æœ¬èº«éƒ½æ˜¯å·¦å€¼ï¼Œç»“åˆè¯¥è§„åˆ™å’Œä¸Šè¡¨ä¾¿å¯åˆ¤æ–­å„ç§æ„é€ å‡½æ•°ã€èµ‹å€¼è¿ç®—ç¬¦ä¸­ä¼ é€’å‚æ•°å’Œå–è¿”å›å€¼çš„å¼•ç”¨ç»‘å®šæƒ…å†µã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">x</span><span class="params">()</span></span>;</span><br><span class="line">Â <span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â &amp;&amp;a=<span class="built_in">x</span>()+<span class="number">1</span>;</span><br><span class="line">Â Â Â Â cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">Â Â Â Â a++;</span><br><span class="line">Â Â Â Â cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â &amp;b=a;</span><br><span class="line">Â Â Â Â b++;</span><br><span class="line">Â Â Â Â cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">x</span><span class="params">()</span></span>&#123;<span class="keyword">return</span>Â <span class="number">1</span>;&#125;</span><br><span class="line">Outputï¼š</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æ­¤ä¾‹ï¼Œå³å€¼å¼•ç”¨æœ¬èº«æ˜¯å·¦å€¼ï¼Œå¯ä»¥è¢«å–åœ°å€ã€‚</p>
<p>ä¾‹ä¸€ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">ref</span><span class="params">(<span class="keyword">int</span>Â &amp;x)</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;leftÂ &quot;</span>Â &lt;&lt;Â xÂ &lt;&lt;Â endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">ref</span><span class="params">(<span class="keyword">int</span>Â &amp;&amp;x)</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;rightÂ &quot;</span>Â &lt;&lt;Â xÂ &lt;&lt;Â endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â aÂ =Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â <span class="built_in">ref</span>(a);</span><br><span class="line">Â Â Â Â <span class="built_in">ref</span>(<span class="number">2</span>);Â <span class="comment">//2æ˜¯ä¸€ä¸ªå¸¸é‡</span></span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line">leftÂ <span class="number">1</span></span><br><span class="line">rightÂ <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ²¡æœ‰å®šä¹‰ ref(int &amp;&amp;x) å‡½æ•°ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<p>ref (int&amp;x)çš„å‡½æ•°å‚æ•°ç±»å‹æ˜¯ä¸€ä¸ªå·¦å€¼å¼•ç”¨ï¼Œè€Œ2æ˜¯ä¸€ä¸ªå³å€¼ï¼Œä¸èƒ½è°ƒç”¨ref (int&amp;x)ã€‚å› æ­¤æ²¡æœ‰å¯ä¾›è°ƒç”¨çš„å‡½æ•°ã€‚<br>[Error] invalid initialization of non-const reference of type â€˜int&amp;â€™ from an rvalue of type â€˜intâ€™ã€‚</p>
<p>ä¾‹äºŒï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">ref</span><span class="params">(<span class="keyword">int</span>Â &amp;x)</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;leftÂ &quot;</span>Â &lt;&lt;Â xÂ &lt;&lt;Â endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">ref</span><span class="params">(<span class="keyword">int</span>Â &amp;&amp;x)</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;rightÂ &quot;</span>Â &lt;&lt;Â xÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â <span class="built_in">ref</span>(x);Â <span class="comment">//è°ƒç”¨å“ªä¸€ä¸ªå‡½æ•°ï¼Ÿ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â <span class="built_in">ref</span>(<span class="number">1</span>);Â <span class="comment">//1æ˜¯ä¸€ä¸ªå¸¸é‡</span></span><br><span class="line"><span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//EncryptStratgy.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EncryptStrategy</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> std::string <span class="title">encode</span><span class="params">(std::string mes)</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InsertStrategy</span>:</span><span class="keyword">public</span> EncryptStrategy&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function">string <span class="title">encode</span><span class="params">(string mes)</span></span>&#123;</span><br><span class="line">		string s=<span class="string">&quot;#&quot;</span>;</span><br><span class="line">		string tmp=mes;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=tmp.<span class="built_in">size</span>();i=i+<span class="number">2</span>)&#123;</span><br><span class="line">			tmp.<span class="built_in">insert</span>(i,s);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> tmp;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InvertStrategy</span>:</span><span class="keyword">public</span> EncryptStrategy&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function">string <span class="title">encode</span><span class="params">(string mes)</span></span>&#123;</span><br><span class="line">		string temp=mes;</span><br><span class="line">		<span class="keyword">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=mes.<span class="built_in">size</span>()<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">			temp[cnt]=mes[i];</span><br><span class="line">			cnt++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> temp;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//verificationstrategy.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta"># <span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VerificationStrategy</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> std::string <span class="title">verify</span><span class="params">(std::string mes)</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PrefixStrategy</span>:</span><span class="keyword">public</span> VerificationStrategy&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function">string <span class="title">verify</span><span class="params">(string mes)</span></span>&#123;</span><br><span class="line">		string ans;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">			ans.<span class="built_in">push_back</span>(mes[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntervalStrategy</span>:</span><span class="keyword">public</span> VerificationStrategy&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function">string <span class="title">verify</span><span class="params">(string mes)</span></span>&#123;</span><br><span class="line">		string ans;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;mes.<span class="built_in">size</span>();i=i+<span class="number">2</span>)&#123;</span><br><span class="line">			ans.<span class="built_in">push_back</span>(mes[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//userproxy.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;User.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;VerificationStrategy.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;EncryptStrategy.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserProxy</span>:</span><span class="keyword">public</span> User&#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    RealUser* m_real;</span><br><span class="line">    EncryptStrategy* m_encrypt;</span><br><span class="line">    VerificationStrategy* m_veri;</span><br><span class="line">    <span class="built_in">UserProxy</span>(RealUser* r_u,EncryptStrategy* e_s,VerificationStrategy* v_s):<span class="built_in">m_real</span>(r_u),<span class="built_in">m_encrypt</span>(e_s),<span class="built_in">m_veri</span>(v_s)&#123;&#125;;</span><br><span class="line">    ~<span class="built_in">UserProxy</span>()&#123;</span><br><span class="line">        <span class="keyword">delete</span> m_real;</span><br><span class="line">        <span class="keyword">delete</span> m_encrypt;</span><br><span class="line">        <span class="keyword">delete</span> m_veri;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">(string mes)</span></span>&#123;</span><br><span class="line">        string temp=m_encrypt-&gt;<span class="built_in">encode</span>(mes);</span><br><span class="line">        m_real-&gt;<span class="built_in">sendMessage</span>(temp);</span><br><span class="line">        cout&lt;&lt;m_veri-&gt;<span class="built_in">verify</span>(mes)&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line">rightÂ <span class="number">1</span></span><br><span class="line">leftÂ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>å¦‚å‰æ–‡æ‰€è¿°ï¼Œæ‰€æœ‰å¼•ç”¨æœ¬èº«éƒ½æ˜¯å·¦å€¼ï¼Œæ•…è€Œref(1)é¦–å…ˆè°ƒç”¨ref(int &amp;&amp;x)å‡½æ•°ï¼Œæ­¤æ—¶å³å€¼å¼•ç”¨xä¸ºå·¦å€¼ï¼Œå› æ­¤ref(x)è°ƒç”¨ref(int &amp;x)å‡½æ•°ã€‚</p>
<h2 id="3-2-ç§»åŠ¨æ„é€ å‡½æ•°"><a href="#3-2-ç§»åŠ¨æ„é€ å‡½æ•°" class="headerlink" title="3.2  ç§»åŠ¨æ„é€ å‡½æ•°"></a>3.2  ç§»åŠ¨æ„é€ å‡½æ•°</h2><h3 id="3-2-1-å®šä¹‰ä¸æ„ä¹‰"><a href="#3-2-1-å®šä¹‰ä¸æ„ä¹‰" class="headerlink" title="3.2.1  å®šä¹‰ä¸æ„ä¹‰"></a>3.2.1  å®šä¹‰ä¸æ„ä¹‰</h3><p>å³å€¼å¼•ç”¨å¯ä»¥å»¶ç»­å³å°†é”€æ¯å˜é‡çš„ç”Ÿå‘½å‘¨æœŸï¼Œç”¨äºæ„é€ å‡½æ•°å¯ä»¥æå‡å¤„ç†æ•ˆç‡ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­å°½å¯èƒ½å°‘åœ°è¿›è¡Œæ‹·è´ã€‚</p>
<p>ä½¿ç”¨å³å€¼å¼•ç”¨ä½œä¸ºå‚æ•°çš„æ„é€ å‡½æ•°å«åšç§»åŠ¨æ„é€ å‡½æ•°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ClassName</span>(ClassName&amp;&amp;Â VariableName);</span><br></pre></td></tr></table></figure>
<h3 id="3-2-2-ä¸¤ç§æ„é€ æœ¬è´¨åŒºåˆ«"><a href="#3-2-2-ä¸¤ç§æ„é€ æœ¬è´¨åŒºåˆ«" class="headerlink" title="3.2.2  ä¸¤ç§æ„é€ æœ¬è´¨åŒºåˆ«"></a>3.2.2  ä¸¤ç§æ„é€ æœ¬è´¨åŒºåˆ«</h3><p>ç§»åŠ¨æ„é€ å‡½æ•°ä¸æ‹·è´æ„é€ å‡½æ•°æœ€ä¸»è¦çš„å·®åˆ«å°±æ˜¯ç±»ä¸­å †å†…å­˜æ˜¯é‡æ–°å¼€è¾Ÿå¹¶æ‹·è´ï¼Œè¿˜æ˜¯ç›´æ¥å°†æŒ‡é’ˆæŒ‡å‘é‚£å—åœ°å€ã€‚å¯¹äºä¸€äº›å³å°†ææ„çš„ä¸´æ—¶ç±»ï¼Œç§»åŠ¨æ„é€ å‡½æ•°ç›´æ¥åˆ©ç”¨äº†åŸæ¥ä¸´æ—¶å¯¹è±¡ä¸­çš„å †å†…å­˜ï¼Œæ–°çš„å¯¹è±¡æ— éœ€å¼€è¾Ÿå†…å­˜ï¼Œä¸´æ—¶å¯¹è±¡æ— éœ€é‡Šæ”¾å†…å­˜ï¼Œä»è€Œå¤§å¤§æé«˜è®¡ç®—æ•ˆç‡ã€‚</p>
<h3 id="3-2-3-ä¾‹å­"><a href="#3-2-3-ä¾‹å­" class="headerlink" title="3.2.3  ä¾‹å­"></a>3.2.3  ä¾‹å­</h3><p>ä¾‹1ï¼šå®Œæ•´å®šä¹‰æ‰€æœ‰å‡½æ•°ä»¥åŠå¯ç”¨è¿”å›å€¼ä¼˜åŒ–</p>
<p>g++ test.cpp â€”std=c++11 -o test</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Test</span>Â &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â *Â buf;Â <span class="comment">////Â onlyÂ forÂ demo.</span></span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>()Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â bufÂ =Â <span class="keyword">new</span>Â <span class="keyword">int</span>[<span class="number">10</span>];Â <span class="comment">//ç”³è¯·ä¸€å—å†…å­˜</span></span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Test():Â this-&gt;bufÂ @Â &quot;</span>Â &lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â ~<span class="built_in">Test</span>()Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;~Test():Â this-&gt;bufÂ @Â &quot;</span>Â &lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (buf)Â <span class="keyword">delete</span>[]Â buf;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;Â t)Â :Â <span class="built_in">buf</span>(<span class="keyword">new</span>Â <span class="keyword">int</span>[<span class="number">10</span>])Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span>Â i=<span class="number">0</span>;Â i&lt;<span class="number">10</span>;Â i++)Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â buf[i]Â =Â t.buf[i];Â <span class="comment">//æ‹·è´æ•°æ®</span></span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Test(constÂ Test&amp;)Â called.Â this-&gt;bufÂ @Â &quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>(Test&amp;&amp;Â t)Â :Â <span class="built_in">buf</span>(t.buf)Â &#123;Â <span class="comment">//ç›´æ¥å¤åˆ¶åœ°å€ï¼Œé¿å…æ‹·è´</span></span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Test(Test&amp;&amp;)Â called.Â this-&gt;bufÂ @Â &quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â Â Â Â Â t.bufÂ =Â <span class="literal">nullptr</span>;Â <span class="comment">//å°†t.bufæ”¹ä¸ºnullptrï¼Œä½¿å…¶ä¸å†æŒ‡å‘åŸæ¥å†…å­˜åŒºåŸŸ</span></span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">TestÂ <span class="title">GetTemp</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â TestÂ tmp;</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;GetTemp():Â tmp.bufÂ @Â &quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â &lt;&lt;Â hexÂ &lt;&lt;Â tmp.bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">fun</span><span class="params">(TestÂ t)</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;fun(TestÂ t):Â t.bufÂ @Â &quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â &lt;&lt;Â hexÂ &lt;&lt;Â t.bufÂ &lt;&lt;Â endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â TestÂ aÂ =Â <span class="built_in">GetTemp</span>();</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;main()Â :Â a.bufÂ @Â &quot;</span>Â &lt;&lt;Â hexÂ &lt;&lt;Â a.bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â <span class="built_in">fun</span>(a);</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">outputï¼š</span><br><span class="line"><span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x7fa908c04b90</span></span><br><span class="line"><span class="built_in">GetTemp</span>():Â tmp.bufÂ @Â <span class="number">0x7fa908c04b90</span></span><br><span class="line"><span class="built_in">main</span>()Â :Â a.bufÂ @Â <span class="number">0x7fa908c04b90</span></span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;)Â called.Â </span><br><span class="line">Â Â Â Â Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x7fa908c04ba0</span></span><br><span class="line"><span class="built_in">fun</span>(TestÂ t):Â t.bufÂ @Â <span class="number">0x7fa908c04ba0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x7fa908c04ba0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x7fa908c04b90</span></span><br></pre></td></tr></table></figure>
<p>æ²¡æœ‰è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä¹Ÿå°‘è°ƒç”¨äº†å‡ æ¬¡æ‹·è´æ„é€ å‡½æ•°ã€‚</p>
<p>å…³é”®ç‚¹åœ¨äºï¼Œè¿”å›å€¼ä¼˜åŒ–ä¹‹åä¸ä¼šé€šè¿‡ç§»åŠ¨æ„é€ æ¥æ„é€ è¿”å›å€¼ç±»ï¼Œä¹Ÿä¸ä¼šé€šè¿‡ç§»åŠ¨æ„é€ æ¥æ„é€ aï¼Œå®ç°äº†ç›´æ¥returnã€‚</p>
<p>ä¾‹2ï¼šå®Œæ•´å®šä¹‰æ‰€æœ‰å‡½æ•°ä½†ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–</p>
<p>g++ test.cpp â€”std=c++11 -fno-elide-constructors -o test</p>
<p>è¿™é‡Œè¯¾ä»¶ä¸Šçš„æ³¨é‡Šæœ‰äº›è¯¯å¯¼ï¼Œæˆ‘åœ¨rextesterè¾“å‡ºè¯¥æ®µä»£ç ï¼Œé‡‡ç”¨çš„æŒ‡ä»¤ä¸ºg++-Wall -std=c++14 -O2 -fno-elide-constructors -o a.out source_file.cpp</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">outputï¼š</span><br><span class="line"><span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x563a2616ae70</span></span><br><span class="line"><span class="built_in">GetTemp</span>():Â tmp.bufÂ @Â <span class="number">0x563a2616ae70</span></span><br><span class="line"><span class="built_in">Test</span>(Test&amp;&amp;)Â called.Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x563a2616ae70</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0</span></span><br><span class="line"><span class="built_in">Test</span>(Test&amp;&amp;)Â called.Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x563a2616ae70</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0</span></span><br><span class="line"><span class="built_in">main</span>()Â :Â a.bufÂ @Â <span class="number">0x563a2616ae70</span></span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;)Â called.Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x563a2616beb0</span></span><br><span class="line"><span class="built_in">fun</span>(TestÂ t):Â t.bufÂ @Â <span class="number">0x563a2616beb0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x563a2616beb0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x563a2616ae70</span></span><br></pre></td></tr></table></figure>
<p>ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–ä½†æ˜¯åŒæ—¶å®šä¹‰äº†ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œæ•…è€Œéœ€è¦é€šè¿‡ç§»åŠ¨æ„é€ æ¥æ„é€ è¿”å›å€¼ç±»ã€‚ä¹‹åç«‹åˆ»å°†tmpææ„(ç”±äºç§»åŠ¨æ„é€ å·²ç»å°†tmpçš„æŒ‡é’ˆç½®ç©ºäº†ï¼Œæ•…è€Œbufåœ°å€ä¸º0)ï¼Œä½†æ˜¯æ²¡æœ‰ææ„è¿”å›å€¼ç±»GetTempã€‚è¿”å›å€¼ç±»GetTempå¯¹aç§»åŠ¨æ„é€ ï¼Œè¿™ä½¿å¾—GetTempçš„bufåœ°å€ä¹Ÿä¸º0ã€‚è¿™ä¸€æ­¥ç§»åŠ¨æ„é€ åï¼Œé©¬ä¸Šææ„äº†GetTempã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œ<code>Test a = GetTemp();</code>è¿™ä¸€è¯­å¥çš„æ‰§è¡Œé¡ºåºæ˜¯å…ˆæ„é€ tmpï¼Œç§»åŠ¨æ„é€ è¿”å›å€¼ç±»ã€‚ç«‹åˆ»ææ„tmpï¼Œè¿”å›å€¼ç±»ç§»åŠ¨æ„é€ aï¼Œæ¥ç€ææ„è¿”å›å€¼ç±»ã€‚</p>
<p>ç»“åˆä¾‹å­2.4.1ï¼Œæˆ‘ä»¬æ¥æ¢ç©¶ä¸‹4,5å’Œè¿”å›å€¼ç±»åœ¨ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–æ¡ä»¶ä¸‹çš„ææ„é¡ºåºã€‚æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼Œç¼–è¯‘æŒ‡ä»¤ä¸ºg++-Wall -std=c++14 -O2 -fno-elide-constructors -o a.out source_file.cpp</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Test</span>Â &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â *Â buf;Â <span class="comment">////Â onlyÂ forÂ demo.</span></span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>()Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â bufÂ =Â <span class="keyword">new</span>Â <span class="keyword">int</span>[<span class="number">10</span>];Â <span class="comment">//ç”³è¯·ä¸€å—å†…å­˜</span></span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Test():Â this-&gt;bufÂ @Â &quot;</span>Â &lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â ~<span class="built_in">Test</span>()Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;~Test():Â this-&gt;bufÂ @Â &quot;</span>Â &lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (buf)Â <span class="keyword">delete</span>[]Â buf;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;Â t)Â :Â <span class="built_in">buf</span>(<span class="keyword">new</span>Â <span class="keyword">int</span>[<span class="number">10</span>])Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span>Â i=<span class="number">0</span>;Â i&lt;<span class="number">10</span>;Â i++)Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â buf[i]Â =Â t.buf[i];Â <span class="comment">//æ‹·è´æ•°æ®</span></span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Test(constÂ Test&amp;)Â called.Â this-&gt;bufÂ @Â &quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>(Test&amp;&amp;Â t)Â :Â <span class="built_in">buf</span>(t.buf)Â &#123;Â <span class="comment">//ç›´æ¥å¤åˆ¶åœ°å€ï¼Œé¿å…æ‹·è´</span></span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Test(Test&amp;&amp;)Â called.Â this-&gt;bufÂ @Â &quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â Â Â Â Â t.bufÂ =Â <span class="literal">nullptr</span>;Â <span class="comment">//å°†t.bufæ”¹ä¸ºnullptrï¼Œä½¿å…¶ä¸å†æŒ‡å‘åŸæ¥å†…å­˜åŒºåŸŸ</span></span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">TestÂ <span class="title">GetTemp</span><span class="params">(TestÂ x)</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â TestÂ tmp;</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;GetTemp():Â tmp.bufÂ @Â &quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â &lt;&lt;Â hexÂ &lt;&lt;Â tmp.bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">fun</span><span class="params">(TestÂ t)</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;fun(TestÂ t):Â t.bufÂ @Â &quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â &lt;&lt;Â hexÂ &lt;&lt;Â t.bufÂ &lt;&lt;Â endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â TestÂ d;</span><br><span class="line">Â Â Â Â TestÂ aÂ =Â <span class="built_in">GetTemp</span>(d);</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;main()Â :Â a.bufÂ @Â &quot;</span>Â &lt;&lt;Â hexÂ &lt;&lt;Â a.bufÂ &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â <span class="built_in">fun</span>(a);</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">Output:</span><br><span class="line"><span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5572ec8c2e70</span></span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;)Â called.Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5572ec8c3eb0</span></span><br><span class="line"><span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5572ec8c3ee0</span></span><br><span class="line"><span class="built_in">GetTemp</span>():Â tmp.bufÂ @Â <span class="number">0x5572ec8c3ee0</span></span><br><span class="line"><span class="built_in">Test</span>(Test&amp;&amp;)Â called.Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5572ec8c3ee0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0</span></span><br><span class="line"><span class="built_in">Test</span>(Test&amp;&amp;)Â called.Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5572ec8c3ee0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5572ec8c3eb0</span></span><br><span class="line"><span class="built_in">main</span>()Â :Â a.bufÂ @Â <span class="number">0x5572ec8c3ee0</span></span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;)Â called.Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5572ec8c3eb0</span></span><br><span class="line"><span class="built_in">fun</span>(TestÂ t):Â t.bufÂ @Â <span class="number">0x5572ec8c3eb0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5572ec8c3eb0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5572ec8c3ee0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5572ec8c2e70</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œå…ˆæ‹·è´æ„é€ äº†xï¼Œæ¥ç€æ„é€ tmpï¼Œç§»åŠ¨æ„é€ GetTempï¼Œé©¬ä¸Šææ„tmpï¼Œç§»åŠ¨æ„é€ aï¼Œææ„GetTempï¼Œææ„xã€‚æ•…4å’Œ5ä¹‹é—´å¯èƒ½è¿˜ä¼šè¿›è¡Œéå¸¸å¤šçš„æ“ä½œã€‚</p>
<p>ä¾‹3ï¼šåˆ é™¤ç§»åŠ¨æ„é€ å‡½æ•°ä¸”ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–</p>
<p>ç¼–è¯‘æŒ‡ä»¤g++-Wall -std=c++14 -O2 -fno-elide-constructors -o a.out source_file.cpp</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Test</span>Â &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">int</span>Â *Â buf;Â <span class="comment">////Â onlyÂ forÂ demo.</span></span><br><span class="line"><span class="built_in">Test</span>()Â &#123;</span><br><span class="line">bufÂ =Â <span class="keyword">new</span>Â <span class="keyword">int</span>[<span class="number">10</span>];Â <span class="comment">//ç”³è¯·ä¸€å—å†…å­˜</span></span><br><span class="line">coutÂ &lt;&lt;Â <span class="string">&quot;Test():Â this-&gt;bufÂ @Â &quot;</span>Â &lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line">&#125;</span><br><span class="line">~<span class="built_in">Test</span>()Â &#123;</span><br><span class="line">coutÂ &lt;&lt;Â <span class="string">&quot;~Test():Â this-&gt;bufÂ @Â &quot;</span>Â &lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line"><span class="keyword">if</span>Â (buf)Â <span class="keyword">delete</span>[]Â buf;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;Â t)Â :Â <span class="built_in">buf</span>(<span class="keyword">new</span>Â <span class="keyword">int</span>[<span class="number">10</span>])Â &#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span>Â i=<span class="number">0</span>;Â i&lt;<span class="number">10</span>;Â i++)Â </span><br><span class="line">buf[i]Â =Â t.buf[i];Â <span class="comment">//æ‹·è´æ•°æ®</span></span><br><span class="line">coutÂ &lt;&lt;Â <span class="string">&quot;Test(constÂ Test&amp;)Â called.Â this-&gt;bufÂ @Â &quot;</span></span><br><span class="line">&lt;&lt;Â hexÂ &lt;&lt;Â bufÂ &lt;&lt;Â endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">TestÂ <span class="title">GetTemp</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">TestÂ tmp;</span><br><span class="line">coutÂ &lt;&lt;Â <span class="string">&quot;GetTemp():Â tmp.bufÂ @Â &quot;</span></span><br><span class="line">&lt;&lt;Â hexÂ &lt;&lt;Â tmp.bufÂ &lt;&lt;Â endl;</span><br><span class="line"><span class="keyword">return</span>Â tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">fun</span><span class="params">(TestÂ t)</span>Â </span>&#123;</span><br><span class="line">coutÂ &lt;&lt;Â <span class="string">&quot;fun(TestÂ t):Â t.bufÂ @Â &quot;</span></span><br><span class="line">&lt;&lt;Â hexÂ &lt;&lt;Â t.bufÂ &lt;&lt;Â endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">TestÂ aÂ =Â <span class="built_in">GetTemp</span>();</span><br><span class="line">coutÂ &lt;&lt;Â <span class="string">&quot;main()Â :Â a.bufÂ @Â &quot;</span>Â &lt;&lt;Â hexÂ &lt;&lt;Â a.bufÂ &lt;&lt;Â endl;</span><br><span class="line"><span class="built_in">fun</span>(a);</span><br><span class="line"><span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">outputï¼š</span><br><span class="line"><span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5638c49e8e70</span></span><br><span class="line"><span class="built_in">GetTemp</span>():Â tmp.bufÂ @Â <span class="number">0x5638c49e8e70</span></span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;)Â called.Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5638c49e9eb0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5638c49e8e70</span></span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;)Â called.Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5638c49e8e70</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5638c49e9eb0</span></span><br><span class="line"><span class="built_in">main</span>()Â :Â a.bufÂ @Â <span class="number">0x5638c49e8e70</span></span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;)Â called.Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5638c49e9eb0</span></span><br><span class="line"><span class="built_in">fun</span>(TestÂ t):Â t.bufÂ @Â <span class="number">0x5638c49e9eb0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5638c49e9eb0</span></span><br><span class="line">~<span class="built_in">Test</span>():Â <span class="keyword">this</span>-&gt;bufÂ @Â <span class="number">0x5638c49e8e70</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œåªæœ‰æ‹·è´æ„é€ ï¼Œç¼–è¯‘å™¨æ²¡æœ‰é»˜è®¤ç”Ÿæˆç§»åŠ¨æ„é€ ã€‚æ‹·è´æ„é€ äº†è¿”å›å€¼ç±»åï¼Œç«‹åˆ»ææ„äº†tmpï¼Œé‡Šæ”¾äº†å°¾å·ä¸º70çš„ç©ºé—´ã€‚æ³¨æ„åˆ°ï¼Œç©ºé—´é‡Šæ”¾ä¹‹åé©¬ä¸Šå°±å¯ä»¥å†æ¬¡è¢«ä½¿ç”¨ï¼Œæ‰€ä»¥è¿”å›å€¼ç±»å»æ‹·è´æ„é€ aæ—¶ï¼Œç”¨çš„ä¾¿æ˜¯ä¸Šæ¬¡è¢«ææ„é‡Šæ”¾å‡ºæ¥çš„å°¾å·ä¸º70çš„ç©ºé—´ã€‚æ¥ä¸‹æ¥ææ„æ‰è¿”å›å€¼ç±»ï¼Œé‡Šæ”¾äº†å°¾å·ä¸ºb0çš„ç©ºé—´ï¼Œä¸‹ä¸€æ¬¡fun(a)å½“ä¸­å¯¹å½¢å‚çš„æ‹·è´æ„é€ é©¬ä¸Šå°±åˆ©ç”¨äº†b0ç©ºé—´ã€‚</p>
<h2 id="3-3-ç§»åŠ¨è¯­å¥"><a href="#3-3-ç§»åŠ¨è¯­å¥" class="headerlink" title="3.3  ç§»åŠ¨è¯­å¥"></a>3.3  ç§»åŠ¨è¯­å¥</h2><h3 id="3-3-1-è¯­æ³•ä¸æ„ä¹‰"><a href="#3-3-1-è¯­æ³•ä¸æ„ä¹‰" class="headerlink" title="3.3.1  è¯­æ³•ä¸æ„ä¹‰"></a>3.3.1  è¯­æ³•ä¸æ„ä¹‰</h3><p>ç§»åŠ¨æ„é€ å‡½æ•°åŠ å¿«äº†å³å€¼åˆå§‹åŒ–çš„æ„é€ é€Ÿåº¦ï¼Œæ•…è€Œå¸Œæœ›å¯¹å·¦å€¼è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ä»¥åŠ å¿«å·¦å€¼åˆå§‹åŒ–çš„æ„é€ é€Ÿåº¦ã€‚</p>
<p>std::moveå‡½æ•°<br>è¾“å…¥ï¼šå·¦å€¼ï¼ˆåŒ…æ‹¬å˜é‡ç­‰ï¼Œè¯¥å·¦å€¼ä¸€èˆ¬ä¸å†ä½¿ç”¨ã€‚ç§»åŠ¨åå°±ä¸èƒ½å†æ¬¡ä½¿ç”¨ï¼‰<br>è¿”å›å€¼ï¼šè¯¥å·¦å€¼å¯¹åº”çš„å³å€¼</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">TestÂ a;</span><br><span class="line">TestÂ bÂ =Â std::<span class="built_in">move</span>(a)Â </span><br><span class="line"><span class="comment">//å¯¹äºä¸Šä¸ªå®ä¾‹ä¸­å®šä¹‰çš„Testç±»ï¼Œè¯¥å¤„è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°å¯¹bè¿›è¡Œåˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure>
<p>moveå‡½æ•°æœ¬èº«ä¸å¯¹å¯¹è±¡åšä»»ä½•æ“ä½œï¼Œ<strong>ä»…åšç±»å‹è½¬æ¢</strong>ï¼Œå³è½¬æ¢ä¸ºå³å€¼ã€‚ç§»åŠ¨çš„å…·ä½“æ“ä½œåœ¨ç§»åŠ¨æ„é€ å‡½æ•°å†…å®ç°ã€‚</p>
<p>å³å€¼å¼•ç”¨ç»“åˆstd::moveå¯ä»¥æ˜¾è‘—æé«˜swapå‡½æ•°çš„æ€§èƒ½ã€‚</p>
<p>std::moveå¼•èµ·ç§»åŠ¨æ„é€ å‡½æ•°æˆ–ç§»åŠ¨èµ‹å€¼è¿ç®—çš„è°ƒç”¨ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>Â &lt;<span class="class"><span class="keyword">class</span>Â <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="built_in">swap</span>(T&amp;Â a,Â T&amp;Â b)Â &#123;Â </span><br><span class="line">Â Â Â Â Â <span class="function">TÂ <span class="title">tmp</span><span class="params">(a)</span></span>;Â <span class="comment">//copyÂ aÂ toÂ tmpÂ </span></span><br><span class="line">Â Â Â Â Â aÂ =Â b;Â <span class="comment">//copyÂ bÂ toÂ aÂ </span></span><br><span class="line">Â Â Â Â Â bÂ =Â tmp;Â <span class="comment">//copyÂ tmpÂ toÂ bÂ </span></span><br><span class="line">&#125;</span><br><span class="line">æ”¹å†™ä¸ºï¼š</span><br><span class="line"><span class="keyword">template</span>Â &lt;<span class="class"><span class="keyword">class</span>Â <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="built_in">swap</span>(T&amp;Â a,Â T&amp;Â b)Â &#123;Â </span><br><span class="line">Â Â Â Â Â <span class="function">TÂ <span class="title">tmp</span><span class="params">(std::move(a))</span></span>;</span><br><span class="line">Â Â Â Â Â aÂ =Â std::<span class="built_in">move</span>(b);</span><br><span class="line">Â Â Â Â Â bÂ =Â std::<span class="built_in">move</span>(tmp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¿å…3æ¬¡ä¸å¿…è¦çš„æ‹·è´æ“ä½œ</p>
<h3 id="3-3-2-ä¾‹å­"><a href="#3-3-2-ä¾‹å­" class="headerlink" title="3.3.2  ä¾‹å­"></a>3.3.2  ä¾‹å­</h3><p>ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Test</span>Â &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>()Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="built_in">printf</span>(<span class="string">&quot;Test()\n&quot;</span>);</span><br><span class="line">Â Â Â Â &#125;Â <span class="comment">//é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">Â Â Â Â ~<span class="built_in">Test</span>()Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="built_in">printf</span>(<span class="string">&quot;~Test()\n&quot;</span>);</span><br><span class="line">Â Â Â Â &#125;Â <span class="comment">//ææ„å‡½æ•°</span></span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>(<span class="keyword">const</span>Â TestÂ &amp;con)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="built_in">printf</span>(<span class="string">&quot;Test(constÂ TestÂ &amp;con)\n&quot;</span>);</span><br><span class="line">Â Â Â Â &#125;Â <span class="comment">//æ‹·è´æ„é€ å‡½æ•°Â Â </span></span><br><span class="line"><span class="function">TestÂ <span class="title">func</span><span class="params">(TestÂ a)</span>Â </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="built_in">Test</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â TestÂ a;</span><br><span class="line">Â Â TestÂ bÂ =Â <span class="built_in">func</span>(a);</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æˆ‘ä»¬ç”¨(1+)å’Œ(1-)è¿™æ ·çš„å½¢å¼æ¥å¯¹åº”ç±»çš„æ„é€ å’Œææ„ã€‚</span></span><br><span class="line">output:</span><br><span class="line"><span class="built_in">Test</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//(1+)Â æ‰§è¡ŒTestÂ aï¼›</span></span><br><span class="line"><span class="built_in">Test</span>(<span class="keyword">const</span>Â TestÂ &amp;con)Â <span class="comment">//(2+)TestÂ bÂ =Â func(a);</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//func(a)ä¼ å‚è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="built_in">Test</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//(3+)returnÂ Test();</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//Test()å¯¹åº”çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="built_in">Test</span>(TestÂ &amp;&amp;con)Â Â Â Â Â Â Â Â <span class="comment">//(4+)returnÂ Test();</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//ä¸ºäº†ä¼ å€¼è°ƒç”¨çš„ç§»åŠ¨æ„é€ å‡½æ•°</span></span><br><span class="line">~<span class="built_in">Test</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//(3-)returnÂ Test();</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//Test()å¯¹åº”çš„ææ„å‡½æ•°</span></span><br><span class="line"><span class="built_in">Test</span>(TestÂ &amp;&amp;con)Â Â Â Â Â Â Â Â <span class="comment">//(5+)TestÂ bÂ =Â func(a);</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//ä¸­ç»™bä¼ å€¼æ—¶è°ƒç”¨çš„ç§»åŠ¨æ„é€ å‡½æ•°</span></span><br><span class="line">~<span class="built_in">Test</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//(4-)TestÂ bÂ =Â func(a);</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//å®Œæˆèµ‹å€¼åfunc(a)è¿”å›å€¼å¯¹åº”çš„ææ„å‡½æ•°</span></span><br><span class="line">~<span class="built_in">Test</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//(2-)TestÂ bÂ =Â func(a);</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//å‚æ•°é‡Šæ”¾å¯¹åº”çš„ææ„å‡½æ•°</span></span><br><span class="line">~<span class="built_in">Test</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//(5-)Â ææ„b</span></span><br><span class="line">~<span class="built_in">Test</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">//(1-)Â ææ„a</span></span><br></pre></td></tr></table></figure>
<p>è¿™å½“ä¸­çš„ææ„é¡ºåºå’Œ3.2.3 ä¾‹äºŒå®Œå…¨ç›¸åŒã€‚</p>
<h2 id="3-4-ä¸¤ç±»æ„é€ å‡½æ•°çš„è°ƒç”¨æ—¶æœº"><a href="#3-4-ä¸¤ç±»æ„é€ å‡½æ•°çš„è°ƒç”¨æ—¶æœº" class="headerlink" title="3.4  ä¸¤ç±»æ„é€ å‡½æ•°çš„è°ƒç”¨æ—¶æœº"></a>3.4  ä¸¤ç±»æ„é€ å‡½æ•°çš„è°ƒç”¨æ—¶æœº</h2><h3 id="3-4-1-åˆ¤æ–­ä¾æ®"><a href="#3-4-1-åˆ¤æ–­ä¾æ®" class="headerlink" title="3.4.1  åˆ¤æ–­ä¾æ®"></a>3.4.1  åˆ¤æ–­ä¾æ®</h3><p>å¼•ç”¨çš„ç»‘å®šè§„åˆ™ï¼š</p>
<p>æ‹·è´æ„é€ å‡½æ•°çš„å½¢å‚ç±»å‹ä¸ºå¸¸é‡å·¦å€¼å¼•ç”¨ï¼Œå¯ä»¥ç»‘å®šå¸¸é‡å·¦å€¼ã€å·¦å€¼å’Œå³å€¼ã€‚ç§»åŠ¨æ„é€ å‡½æ•°çš„å½¢å‚ç±»å‹ä¸ºå³å€¼å¼•ç”¨ï¼Œå¯ä»¥ç»‘å®šå³å€¼ã€‚å¼•ç”¨çš„ç»‘å®šå­˜åœ¨ä¼˜å…ˆçº§ï¼Œä¾‹å¦‚å¸¸é‡å·¦å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨å‡èƒ½ç»‘å®šå³å€¼ï¼Œå½“ä¼ å…¥å®å‚ç±»å‹ä¸ºå³å€¼æ—¶ä¼˜å…ˆåŒ¹é…å½¢å‚ç±»å‹ä¸ºå³å€¼å¼•ç”¨çš„å‡½æ•°ã€‚</p>
<h3 id="3-4-2-æ‹·è´æ„é€ å‡½æ•°çš„å¸¸è§è°ƒç”¨æ—¶æœº"><a href="#3-4-2-æ‹·è´æ„é€ å‡½æ•°çš„å¸¸è§è°ƒç”¨æ—¶æœº" class="headerlink" title="3.4.2  æ‹·è´æ„é€ å‡½æ•°çš„å¸¸è§è°ƒç”¨æ—¶æœº"></a>3.4.2  æ‹·è´æ„é€ å‡½æ•°çš„å¸¸è§è°ƒç”¨æ—¶æœº</h3><p>ç”¨ä¸€ä¸ªç±»å¯¹è±¡/å¼•ç”¨/å¸¸é‡å¼•ç”¨åˆå§‹åŒ–å¦ä¸€ä¸ªæ–°çš„ç±»å¯¹è±¡<br>ä»¥ç±»çš„å¯¹è±¡ä¸ºå‡½æ•°å½¢å‚ï¼Œä¼ å…¥å®å‚ä¸ºç±»çš„å¯¹è±¡/å¼•ç”¨/å¸¸é‡å¼•ç”¨<br>å‡½æ•°è¿”å›ç±»å¯¹è±¡ï¼ˆç±»ä¸­æœªæ˜¾å¼å®šä¹‰ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä¸è¿›è¡Œè¿”å›å€¼ä¼˜åŒ–ï¼‰</p>
<h3 id="3-4-3-ç§»åŠ¨æ„é€ å‡½æ•°çš„å¸¸è§è°ƒç”¨æ—¶æœº"><a href="#3-4-3-ç§»åŠ¨æ„é€ å‡½æ•°çš„å¸¸è§è°ƒç”¨æ—¶æœº" class="headerlink" title="3.4.3  ç§»åŠ¨æ„é€ å‡½æ•°çš„å¸¸è§è°ƒç”¨æ—¶æœº"></a>3.4.3  ç§»åŠ¨æ„é€ å‡½æ•°çš„å¸¸è§è°ƒç”¨æ—¶æœº</h3><p>ç”¨ä¸€ä¸ªç±»å¯¹è±¡çš„å³å€¼åˆå§‹åŒ–å¦ä¸€ä¸ªæ–°çš„ç±»å¯¹è±¡ï¼ˆå¸¸é…åˆstd::moveå‡½æ•°ä¸€èµ·ä½¿ç”¨ï¼‰: <code>Test b = func(a); Test b = std::move(a);</code> ä¸<code>Test b = a;</code> ä¸åŒ</p>
<p>ä»¥ç±»çš„å¯¹è±¡ä¸ºå‡½æ•°å½¢å‚,ä¼ å…¥å®å‚ä¸ºç±»å¯¹è±¡çš„å³å€¼(å¸¸é…åˆstd::moveå‡½æ•°ä½¿ç”¨):<code>func(Test());func(std::move(a));</code></p>
<p>ä¸func(a)ä¸åŒå‡½æ•°è¿”å›ç±»å¯¹è±¡ï¼ˆç±»ä¸­æ˜¾å¼å®šä¹‰ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä¸è¿›è¡Œè¿”å›å€¼ä¼˜åŒ–ï¼‰: <code>&#123;return Test(); or return tmp;&#125;</code>å‡è°ƒç”¨ç§»åŠ¨æ„é€ </p>
<p><img src="https://s2.loli.net/2022/01/11/upOzJL2Vgl9PYfB.png" alt="https://s2.loli.net/2022/01/11/upOzJL2Vgl9PYfB.png"></p>
<p>æ³¨æ„åˆ°Dæ˜¯é”™çš„ï¼Œè¿”å›å€¼è™½ç„¶æ˜¯éé™æ€ä¸´æ—¶å˜é‡çš„å¸¸é‡å·¦å€¼å¼•ç”¨ï¼Œä½†æ˜¯è¿”å›ç±»å‹æ ¹æœ¬ä¸æ˜¯å¼•ç”¨ï¼Œå¹¶ä¸æ˜¯è¿”å›ä¸´æ—¶å˜é‡çš„å¼•ç”¨ã€‚</p>
<h1 id="å››ã€æ‹·è´ä¸ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦"><a href="#å››ã€æ‹·è´ä¸ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="å››ã€æ‹·è´ä¸ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦"></a>å››ã€æ‹·è´ä¸ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</h1><h2 id="4-1-æ‹·è´èµ‹å€¼è¿ç®—ç¬¦å®šä¹‰ä¸æ„ä¹‰"><a href="#4-1-æ‹·è´èµ‹å€¼è¿ç®—ç¬¦å®šä¹‰ä¸æ„ä¹‰" class="headerlink" title="4.1  æ‹·è´èµ‹å€¼è¿ç®—ç¬¦å®šä¹‰ä¸æ„ä¹‰"></a>4.1  æ‹·è´èµ‹å€¼è¿ç®—ç¬¦å®šä¹‰ä¸æ„ä¹‰</h2><p>å·²å®šä¹‰çš„å¯¹è±¡ä¹‹é—´ç›¸äº’èµ‹å€¼ï¼Œå¯é€šè¿‡è°ƒç”¨å¯¹è±¡çš„â€œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°â€æ¥å®ç°çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">ClassName&amp;Â <span class="keyword">operator</span>=Â (<span class="keyword">const</span>Â ClassName&amp;Â right)Â &#123;</span><br><span class="line">Â Â Â <span class="keyword">if</span>Â (<span class="keyword">this</span>Â !=Â &amp;right)Â &#123;<span class="comment">//Â é¿å…è‡ªå·±èµ‹å€¼ç»™è‡ªå·±</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//Â å°†rightå¯¹è±¡ä¸­çš„å†…å®¹æ‹·è´åˆ°å½“å‰å¯¹è±¡ä¸­...</span></span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â <span class="keyword">return</span>Â *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ä½œå‡ºåŒºåˆ†ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">ClassNameÂ a;</span><br><span class="line">ClassNameÂ b;</span><br><span class="line">aÂ =Â b;</span><br><span class="line"><span class="comment">//æ­¤å¤„ä¸ºæ‹·è´å¤åˆ¶è¿ç®—</span></span><br><span class="line">ClassNameÂ aÂ =Â b;</span><br><span class="line"><span class="comment">//æ­¤å¤„ä¸ºå®šä¹‰æ–°å¯¹è±¡</span></span><br></pre></td></tr></table></figure>
<p>èµ‹å€¼é‡è½½å‡½æ•°å¿…é¡»è¦æ˜¯ç±»çš„éé™æ€æˆå‘˜å‡½æ•°(non-static member function)ï¼Œä¸èƒ½æ˜¯å‹å…ƒå‡½æ•°ã€‚å› ä¸ºå¤åˆ¶è¿ç®—æ˜¯å¯¹äºè¿™ä¸ªç±»è€Œè¨€çš„ï¼Œæ˜¾ç„¶æ˜¯ç±»å‡½æ•°ã€‚åŒæ—¶ï¼Œèµ‹å€¼è¿ç®—ä¾èµ–äºå…·ä½“çš„å¯¹è±¡ï¼Œä¸èƒ½æ˜¯é™æ€çš„ã€‚ï¼ˆè¯¦è§L4 åˆ›å»ºä¸é”€æ¯2ç¬”è®°ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">Test&amp;Â <span class="keyword">operator</span>=Â (<span class="keyword">const</span>Â Test&amp;Â right)Â &#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>Â (<span class="keyword">this</span>Â ==Â &amp;right)Â Â coutÂ &lt;&lt;Â <span class="string">&quot;sameÂ obj!\n&quot;</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">else</span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span>Â i=<span class="number">0</span>;Â i&lt;<span class="number">10</span>;Â i++)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â buf[i]Â =Â right.buf[i];Â Â <span class="comment">//æ‹·è´æ•°æ®</span></span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;operator=(constÂ Test&amp;)Â called.\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-2-ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ä½œç”¨ä¸æ„ä¹‰"><a href="#4-2-ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ä½œç”¨ä¸æ„ä¹‰" class="headerlink" title="4.2  ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ä½œç”¨ä¸æ„ä¹‰"></a>4.2  ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ä½œç”¨ä¸æ„ä¹‰</h2><p>å’Œç§»åŠ¨æ„é€ å‡½æ•°åŸç†ç±»ä¼¼</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">Test&amp;Â <span class="keyword">operator</span>=Â (Test&amp;&amp;Â right)Â &#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>Â (<span class="keyword">this</span>Â ==Â &amp;right)Â Â coutÂ &lt;&lt;Â <span class="string">&quot;sameÂ obj!\n&quot;</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">else</span>Â &#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">this</span>-&gt;bufÂ =Â right.buf;Â Â <span class="comment">//ç›´æ¥èµ‹å€¼åœ°å€</span></span><br><span class="line">Â Â Â Â Â Â Â Â right.bufÂ =Â <span class="literal">nullptr</span>;</span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;operator=(Test&amp;&amp;)Â called.\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">swap</span>(Test&amp;Â a,Â Test&amp;Â b)Â &#123;Â </span><br><span class="line">Â Â Â Â Â <span class="function">TestÂ <span class="title">tmp</span><span class="params">(std::move(a))</span></span>;Â <span class="comment">//Â ç¬¬ä¸€è¡Œè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°</span></span><br><span class="line">Â Â Â Â Â aÂ =Â std::<span class="built_in">move</span>(b);Â Â Â Â Â Â Â <span class="comment">//Â std::moveçš„ç»“æœä¸ºå³å€¼å¼•ç”¨ï¼Œ</span></span><br><span class="line">Â Â Â Â Â bÂ =Â std::<span class="built_in">move</span>(tmp);Â <span class="comment">//Â åä¸¤è¡Œå‡è°ƒç”¨ç§»åŠ¨èµ‹å€¼è¿ç®—</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-3-è°ƒç”¨æ—¶æœº"><a href="#4-3-è°ƒç”¨æ—¶æœº" class="headerlink" title="4.3  è°ƒç”¨æ—¶æœº"></a>4.3  è°ƒç”¨æ—¶æœº</h2><p>å’Œæ‹·è´/ç§»åŠ¨æ„é€ å‡½æ•°çš„è°ƒç”¨æ—¶æœºç±»ä¼¼ï¼Œä¸»è¦åˆ¤æ–­ä¾æ®æ˜¯å¼•ç”¨çš„ç»‘å®šè§„åˆ™</p>
<p>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°çš„å½¢å‚ç±»å‹ä¸ºå¸¸é‡å·¦å€¼å¼•ç”¨ï¼Œå¯ä»¥ç»‘å®šå¸¸é‡å·¦å€¼ã€å·¦å€¼å’Œå³å€¼</p>
<p>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°çš„å½¢å‚ç±»å‹ä¸ºå³å€¼å¼•ç”¨ï¼Œå¯ä»¥ç»‘å®šå³å€¼(å¸¸é‡ã€è¡¨è¾¾å¼ã€å‡½æ•°è¿”å›)</p>
<p>å¼•ç”¨çš„ç»‘å®šå­˜åœ¨ä¼˜å…ˆçº§ï¼Œä¾‹å¦‚å¸¸é‡å·¦å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨å‡èƒ½ç»‘å®šå³å€¼ï¼Œå½“èµ‹å€¼è¿ç®—ç¬¦å³ä¾§ä¸ºå³å€¼æ—¶ä¼˜å…ˆåŒ¹é…å½¢å‚ç±»å‹ä¸ºå³å€¼å¼•ç”¨çš„èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°</p>
<p>æ ¹æ®èµ‹å€¼è¿ç®—ç¬¦å³ä¾§å˜é‡çš„ç±»å‹å†³å®šè°ƒç”¨æ‹·è´æˆ–ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°</p>
<h2 id="4-4-è‡ªåŠ¨åˆæˆçš„å‡½æ•°ä¸è¿ç®—ç¬¦"><a href="#4-4-è‡ªåŠ¨åˆæˆçš„å‡½æ•°ä¸è¿ç®—ç¬¦" class="headerlink" title="4.4  è‡ªåŠ¨åˆæˆçš„å‡½æ•°ä¸è¿ç®—ç¬¦"></a>4.4  è‡ªåŠ¨åˆæˆçš„å‡½æ•°ä¸è¿ç®—ç¬¦</h2><p>ç±»ä¸­ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°/è¿ç®—ç¬¦ï¼Œå³ä¾¿ç”¨æˆ·ä¸æ˜¾å¼å®šä¹‰ï¼Œç¼–è¯‘å™¨ä¹Ÿä¼šæ ¹æ®è‡ªèº«éœ€è¦è‡ªåŠ¨åˆæˆã€‚</p>
<p>é»˜è®¤æ„é€ å‡½æ•°<br>æ‹·è´æ„é€ å‡½æ•°<br>ç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆC++11èµ·ï¼‰<br>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦<br>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼ˆC++11èµ·ï¼‰<br>ææ„å‡½æ•°</p>
<h1 id="äº”ã€è¿”å›å€¼ä¼˜åŒ–"><a href="#äº”ã€è¿”å›å€¼ä¼˜åŒ–" class="headerlink" title="äº”ã€è¿”å›å€¼ä¼˜åŒ–"></a>äº”ã€è¿”å›å€¼ä¼˜åŒ–</h1><p>è¯¥éƒ¨åˆ†ä¸»è¦æ˜¯ç¬¬ä¸‰æ¬¡ä½œä¸šç¬¬äºŒé¢˜çš„è§£æï¼Œå»ºè®®ç»“åˆé˜…è¯»ã€‚</p>
<h2 id="5-1-ä¼˜åŒ–æ¡ä»¶"><a href="#5-1-ä¼˜åŒ–æ¡ä»¶" class="headerlink" title="5.1  ä¼˜åŒ–æ¡ä»¶"></a>5.1  ä¼˜åŒ–æ¡ä»¶</h2><ol>
<li>returnçš„å€¼ç±»å‹ä¸å‡½æ•°å‰é¢çš„è¿”å›å€¼ç±»å‹ç›¸åŒã€‚</li>
<li>returnçš„æ˜¯ä¸€ä¸ªå±€éƒ¨å¯¹è±¡çš„å·¦å€¼ã€‚</li>
</ol>
<h2 id="5-2-ä¼˜åŒ–æ„ä¹‰"><a href="#5-2-ä¼˜åŒ–æ„ä¹‰" class="headerlink" title="5.2  ä¼˜åŒ–æ„ä¹‰"></a>5.2  ä¼˜åŒ–æ„ä¹‰</h2><ol>
<li>åœ¨ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–çš„æ¡ä»¶ä¸‹ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯æŸä¸ªå¯¹è±¡ï¼Œé‚£åœ¨å‡½æ•°è¿”å›å‰éœ€è¦è°ƒç”¨æ„é€ å‡½æ•°æ„å»ºè¿”å›å€¼ã€‚</li>
<li>å³ä½¿æˆ‘è¿”å›çš„ä¸œè¥¿å°±æ˜¯æˆ‘ä¼ è¿›æ¥çš„å½¢å‚å¯¹è±¡ï¼Œè¿”å›å‰çš„è¿™æ¬¡æ„é€ ä»ç„¶ä¼šå‘ç”Ÿï¼Œä¹Ÿå°±æ˜¯è¿™é“é¢˜ä¸­f1çš„ç¬¬äºŒæ¬¡æ„é€ å‡½æ•°è°ƒç”¨ã€‚</li>
<li>ä½†æ˜¯å¯¹äºè¿”å›å€¼çš„æ„é€ è°ƒç”¨çš„åˆ°åº•æ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œè¿˜æ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Œå¯¹æ­¤C++11æœ‰è§„å®šï¼šåœ¨æ— è¿”å›å€¼ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ã€‚</li>
<li>ç»¼ä¸Šæ‰€è¿°ï¼Œè¿”å›ä¸€ä¸ªå±€éƒ¨å¯¹è±¡çš„å·¦å€¼ï¼Œé€šè¿‡ç§»åŠ¨æ„é€ æ„é€ è¿”å›å€¼ï¼Œè¿”å›å€¼å†ç§»åŠ¨èµ‹å€¼æˆ–ç§»åŠ¨æ„é€ ç»™ä¸»å‡½æ•°è¯­å¥ã€‚</li>
</ol>
<h2 id="5-3-ä¼˜åŒ–å®ä¾‹"><a href="#5-3-ä¼˜åŒ–å®ä¾‹" class="headerlink" title="5.3  ä¼˜åŒ–å®ä¾‹"></a>5.3  ä¼˜åŒ–å®ä¾‹</h2><ul>
<li>å¦‚æœå¼€å¯äº†è¿”å›å€¼ä¼˜åŒ–ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘çš„å‡½æ•°é‡Œæ–°å®šä¹‰äº†ä¸€ä¸ªTestå¯¹è±¡ã€‚ï¼ˆæ¯”å¦‚ï¼šTest tmp; return tmp;)é‚£ç¼–è¯‘å™¨ä¼šç»™æˆ‘ä¼˜åŒ–ï¼Œå…ˆç”¨æ„é€ å‡½æ•°æ„é€ tmpï¼Œç„¶åç›´æ¥è¿”å›tmpã€‚</li>
<li>è¿™é‡Œç”šè‡³ä¸ä¼šè°ƒç”¨ç§»åŠ¨æ„é€ ï¼Œä¹Ÿå°±æ˜¯è¯´ç”šè‡³ä¸æ˜¯ç”¨tmpç§»åŠ¨æ„é€ äº†è¦è¿”å›çš„å¯¹è±¡ï¼Œå°±æ˜¯ç›´æ¥è¿”å›ã€‚</li>
<li>ä½†å¦‚æœæ²¡æœ‰å¼€å¯ä¼˜åŒ–ï¼Œä¼šé¦–å…ˆè°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°æ„é€ tmpï¼Œç„¶åè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°å°†ç”¨tmpç§»åŠ¨æ„é€ è¿”å›å€¼ã€‚</li>
</ul>
<h2 id="5-4-è¿”å›å€¼æ„é€ "><a href="#5-4-è¿”å›å€¼æ„é€ " class="headerlink" title="5.4  è¿”å›å€¼æ„é€ "></a>5.4  è¿”å›å€¼æ„é€ </h2><ul>
<li>å¦‚æœè¿”å›å€¼æ˜¯æ™®é€šçš„Testçš„è¯ï¼Œé‚£ä¹ˆå‡½æ•°è¿”å›æ—¶éœ€è¦æ ¹æ®returnåé¢çš„è¡¨è¾¾å¼æ¥æ„é€ ä¸€ä¸ªTestå¯¹è±¡ï¼Œæ‰€ä»¥æ‰æœ‰ç§»åŠ¨æ„é€ æˆ–è€…æ‹·è´æ„é€ çš„äº‹æƒ…ã€‚</li>
<li>å¦‚æœå‡½æ•°è¿”å›ç±»å‹æ˜¯const &amp;æˆ–è€…&amp;ï¼Œé‚£returnçš„æ—¶å€™å°±æ²¡å¿…è¦å†æ„é€ æ–°çš„å¯¹è±¡äº†ï¼Œç›´æ¥è¿”å›ç›¸åº”çš„å¼•ç”¨ã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">(<span class="number">5</span>)<span class="function"><span class="keyword">const</span>Â Test&amp;Â <span class="title">F</span><span class="params">(<span class="keyword">const</span>Â Test&amp;Â a)</span></span>&#123;</span><br><span class="line">Â Â Â Â TestÂ bÂ =Â a;</span><br><span class="line"><span class="keyword">return</span>Â <span class="built_in">Test</span>(<span class="number">1</span>);&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â TestÂ a;</span><br><span class="line">Â Â Â Â <span class="keyword">const</span>Â TestÂ &amp;AÂ =Â <span class="built_in">F</span>(std::<span class="built_in">move</span>(a));</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>æ¯”å¦‚æ­¤å¤„ï¼Œç”±äºæˆ‘çš„å‡½æ•°è¿”å›ç±»å‹ä¸ºå¼•ç”¨ï¼Œæ•…è€Œç›´æ¥è¿”å›äº†è¿”å›å€¼çš„å¼•ç”¨ã€‚ä¹Ÿå°±æ˜¯Test(1)çš„å¸¸é‡å·¦å€¼å¼•ç”¨ã€‚ä½†æ˜¯ï¼Œåœ¨å‡½æ•°ç»“æŸä¹‹åï¼Œè¿™ä¸ªå¸¸å€¼å¼•ç”¨æ‰€å¼•ç”¨çš„Test(1)å°±è¢«ææ„äº†ï¼Œé‚£è¿™ä¸ªå¸¸å€¼å¼•ç”¨å°±æ²¡ç”¨äº†ã€‚</p>
<p>æ€»è€Œè¨€ä¹‹ï¼ŒFçš„è¿”å›ç±»å‹æ˜¯ä¸€ä¸ªå¸¸é‡å·¦å€¼å¼•ç”¨ï¼Œè€Œè¿”å›å€¼æ˜¯Test(1)è¿™ä¸€ä¸´æ—¶å˜é‡ã€‚ä¸´æ—¶å˜é‡ä¼šåœ¨å‡½æ•°ä½“ç»“æŸåè¢«ææ„ï¼Œä»è€Œå¼•ç”¨å¤±æ•ˆã€‚æ•…è€Œä¸èƒ½è¿”å›ä¸´æ—¶å˜é‡çš„å¼•ç”¨ï¼Œä»è€Œç¼–è¯‘é”™è¯¯ã€‚</p>
<p>ä¸è¿‡ï¼ŒTest(1)æ„Ÿè§‰åªæ˜¯ä¸ªä¸´æ—¶çš„å³å€¼ï¼Œè¿™èƒ½ç§°ä¸ºä¸´æ—¶å˜é‡å—ï¼Ÿ<br>å®é™…ä¸Šæ˜¯å¯ä»¥çš„ï¼Œå¦‚æœå»çœ‹ç¼–è¯‘å¾—åˆ°çš„æ±‡ç¼–ç ï¼Œ<code>return test(1);</code>å’Œ<code>Test ret = test(1); return ret;</code>ç”Ÿæˆçš„æ±‡ç¼–ç æ˜¯ä¸€æ ·çš„ã€‚</p>
<h2 id="5-5-ä¾‹å­"><a href="#5-5-ä¾‹å­" class="headerlink" title="5.5  ä¾‹å­"></a>5.5  ä¾‹å­</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Test</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â dataÂ =Â <span class="number">0</span>;</span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>()&#123;&#125;</span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>(<span class="keyword">const</span>Â Test&amp;Â t)&#123;&#125;</span><br><span class="line">Â Â Â Â <span class="built_in">Test</span>(Test&amp;&amp;Â t)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">TestÂ <span class="title">fn1</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â TestÂ tmp;Â <span class="keyword">return</span>Â tmp;Â <span class="comment">//(1)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Test&amp;&amp;Â <span class="title">fn2</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â TestÂ tmp;Â <span class="keyword">return</span>Â <span class="built_in">move</span>(tmp);Â <span class="comment">//(2)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">TestÂ <span class="title">fn3</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â TestÂ tmp;Â <span class="keyword">return</span>Â <span class="built_in">move</span>(tmp);Â <span class="comment">//(3)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">const</span>Â Test&amp;Â aÂ =Â <span class="built_in">fn1</span>();Â <span class="comment">//(4)</span></span><br><span class="line">Â Â Â Â Test&amp;&amp;Â bÂ =Â <span class="built_in">fn1</span>();Â <span class="comment">//(5)</span></span><br><span class="line">Â Â Â Â TestÂ cÂ =Â <span class="built_in">fn1</span>();Â <span class="comment">//(6)</span></span><br><span class="line">Â Â Â Â Test&amp;&amp;Â dÂ =Â <span class="built_in">fn2</span>();Â <span class="comment">//(7)</span></span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å»ºè®®åšæ³•åŒ…æ‹¬(1)(4)(5)(6),é¿å…å¤šä½™æ‹·è´ï¼Œä¼˜åŒ–èµ„æºåˆ©ç”¨</p>
<p>Test fn1(); æ»¡è¶³è¿”å›å€¼ä¼˜åŒ–æ¡ä»¶<br>å¯åˆ©ç”¨å¸¸é‡å·¦å€¼å¼•ç”¨(2)ï¼Œå³å€¼å¼•ç”¨(5)ï¼Œæ„é€ æ–°å¯¹è±¡(7)çš„æ–¹å¼æ¥æ”¶è¿”å›å€¼<br>ä¸å»ºè®®åšæ³•åŒ…æ‹¬(2)(3)(7)<br>(2)(7) dä¼šæŒ‡å‘è¢«ææ„çš„tmpï¼Œå‡ºç°è¿è¡Œé”™è¯¯<br>std::move()å°†å·¦å€¼è½¬å˜ä¸ºå³å€¼ï¼Œä¸è¿›è¡Œè¿”å›å€¼ä¼˜åŒ–ï¼Œ(3)ä¼šç§»åŠ¨æ„é€ ä¸´æ—¶å˜é‡</p>
<p>å…³äº(2)(7)ï¼Œé¦–å…ˆè®°ä½ï¼Œå¦‚æœè¿”å›å¼•ç”¨ï¼Œåªæœ‰è¿”å›å¸¸é‡å±€éƒ¨å˜é‡çš„å·¦å€¼å¼•ç”¨æ˜¯åˆæ³•çš„ï¼Œå…¶ä»–çš„éƒ½ä¸åˆæ³•ã€‚å³ä½¿åœ¨æŸäº›ç¼–è¯‘å™¨ä¸Šé€šè¿‡äº†ï¼Œä¹Ÿå¾ˆå±é™©ã€‚åœ¨è¾ƒä¸ºä¸¥æ ¼çš„ç¼–è¯‘å™¨ä¸Šä¸ä¸€å®šèƒ½é€šè¿‡ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>Â &amp;<span class="title">func</span><span class="params">()</span></span>&#123;<span class="keyword">static</span>Â <span class="keyword">int</span>Â x=<span class="number">0</span>;<span class="keyword">return</span>Â x;&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨æ­¤å¤„(2)(7)ä¸¾ä¾‹ï¼Œ(2)(7)çš„æ„æ€æ˜¯è¿”å›äº†ä¸€ä¸ªå³å€¼çš„å³å€¼å¼•ç”¨ï¼ŒæŠŠè¿™ä¸ªå³å€¼å¼•ç”¨çš„è¿”å›å€¼èµ‹å€¼ç»™äº†ä¸€ä¸ªå³å€¼å¼•ç”¨ã€‚</p>
<p>æˆ‘ä»¬å†™å‡ºå¦‚ä¸‹ä¸€ä¸ªç±»ä¼¼çš„ä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="function"><span class="keyword">int</span>&amp;&amp;<span class="title">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â tmp=<span class="number">1</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â std::<span class="built_in">move</span>(tmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>&amp;&amp;x=<span class="built_in">func</span>()+<span class="number">1</span>;</span><br><span class="line">Â Â Â Â cout&lt;&lt;x;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‡‡ç”¨glotå¹³å°è¿è¡Œï¼Œoutputï¼š2</p>
<p>é‡‡ç”¨retexterå¹³å°è¿è¡Œï¼Œç¼–è¯‘æŒ‡ä»¤é‡‡ç”¨clang++-Wall -std=c++14 -stdlib=libc++ -O2 -o a.out source_file.cppï¼Œè¾“å‡ºç»“æœä¸ºå®Œå…¨ä¸ç¡®å®šçš„æ•´æ•°ã€‚è™½ç„¶ç›´è§‰ä¸Šå¯ä»¥å®Œæˆèµ‹å€¼ï¼Œä½†æ˜¯ç”±äºtmpä¸æ˜¯é™æ€å±€éƒ¨å˜é‡ï¼Œé€è¯­å¥ç»“æŸåä¼šè¢«ææ„ï¼Œå¯¼è‡´xåœ¨è®¿é—®éæ³•å†…å­˜ã€‚</p>
<p>é‡‡ç”¨retexterå¹³å°è¿è¡Œï¼Œç¼–è¯‘æŒ‡ä»¤é‡‡ç”¨g++â€”Wall -std=c++14 -O2 -o a.out source_file.cppï¼Œè¾“å‡ºç»“æœä¸º1ï¼Œwarningå¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="number">1944460822</span>/source.cpp:Â InÂ functionÂ <span class="string">&#x27;int&amp;&amp;Â func()&#x27;</span>:</span><br><span class="line"><span class="number">1944460822</span>/source.cpp:<span class="number">5</span>:<span class="number">25</span>:Â warning:Â functionÂ returnsÂ addressÂ ofÂ localÂ variableÂ [-Wreturn-local-addr]</span><br><span class="line"><span class="keyword">return</span>Â std::<span class="built_in">move</span>(tmp);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ^</span><br><span class="line"><span class="number">1944460822</span>/source.cpp:<span class="number">4</span>:<span class="number">9</span>:Â note:Â declaredÂ here</span><br><span class="line">Â Â Â Â Â <span class="keyword">int</span>Â tmp=<span class="number">1</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â ^~~</span><br><span class="line"><span class="number">1944460822</span>/source.cpp:Â InÂ functionÂ â€˜<span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>â€™:</span></span><br><span class="line"><span class="function"><span class="number">1944460822</span>/source.cpp:<span class="number">8</span>:<span class="number">19</span>:Â warning:Â â€˜tmpâ€™Â isÂ usedÂ uninitializedÂ inÂ thisÂ functionÂ [-Wuninitialized]</span></span><br><span class="line"><span class="function">Â Â Â Â Â int&amp;&amp;x=</span><span class="built_in">func</span>()+<span class="number">1</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ^</span><br></pre></td></tr></table></figure>
<p>æ€»è€Œè¨€ä¹‹ï¼Œè¿”å›éé™æ€ä¸´æ—¶å˜é‡çš„å¼•ç”¨é£é™©æå¤§ã€‚</p>
<p>å¤‡æ³¨ï¼šè¿™ä¸ªä¾‹å­æœ¬èº«å¹¶ä¸å¤ªå¥½ã€‚å¦‚æœå®åœ¨æƒ³æ£€æµ‹è¿™æ ·çš„å‡½æ•°ï¼Œä¸åº”è¯¥ç”¨intç±»å‹ã€‚å› ä¸ºintæ˜¯ç¼–è¯‘å™¨è‡ªå¸¦çš„åŸºæœ¬ç±»å‹ï¼Œé‡‡ç”¨è¿‡å¤šçš„ä¼˜åŒ–ï¼Œæ•…è€Œglotè¾“å‡º2ä¹Ÿæ˜¯åˆç†çš„ã€‚è¿™æ ·çš„æ£€æµ‹æœ€å¥½ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹å¹¶å®Œæ•´åœ°å®šä¹‰æ‰€æœ‰çš„æ„é€ ï¼Œææ„ï¼Œæ‹·è´æ„é€ ï¼Œç§»åŠ¨æ„é€ ï¼Œç§»åŠ¨èµ‹å€¼ä¸æ‹·è´èµ‹å€¼ï¼Œç¡®ä¿ç¼–è¯‘å™¨ä¼˜åŒ–ä¸å¤šã€‚</p>
<h1 id="å…­ã€delete-ä¸æ£€æµ‹"><a href="#å…­ã€delete-ä¸æ£€æµ‹" class="headerlink" title="å…­ã€delete ä¸æ£€æµ‹"></a>å…­ã€delete ä¸æ£€æµ‹</h1><p>è¯¥éƒ¨åˆ†ä¸ºç¬¬ä¸‰æ¬¡ä½œä¸šç¬¬ä¸‰é¢˜çš„è§£æï¼Œå»ºè®®ç»“åˆé˜…è¯»</p>
<hr>
<h2 id="6-1-Delete-çš„æ„ä¹‰"><a href="#6-1-Delete-çš„æ„ä¹‰" class="headerlink" title="6.1  Delete çš„æ„ä¹‰"></a>6.1  Delete çš„æ„ä¹‰</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span>[]array;<span class="comment">//deleteï¼šé‡Šæ”¾æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åŒº</span></span><br></pre></td></tr></table></figure>
<p>æ•…è€Œdeleteä¹‹åï¼Œå†…å­˜åŒºçš„æ•°æ®å°±æ¸…é™¤äº†ã€‚</p>
<p>deleteé‡Šæ”¾çš„æ˜¯æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼ŒæŒ‡é’ˆå˜é‡æœ¬èº«ä»ç„¶å­˜åœ¨å¯ä»¥ä½¿ç”¨ï¼ˆç”¨äºèµ‹å€¼etcï¼‰ã€‚ä½†æ˜¯è°ƒç”¨array[i]ä¼šäº§ç”Ÿè¿è¡Œæ—¶é”™è¯¯segmentation faultï¼Œå› ä¸ºå®ƒæ²¡æœ‰æŒ‡å‘ä¸€å—å†…å­˜ç©ºé—´ç”¨äºå­˜å‚¨æ•°æ®ã€‚</p>
<p>æ¸…é™¤ä¸ç­‰åŒäºè®¾ä¸º0ã€‚è€Œä¸”å®é™…ä¸Šï¼Œåœ¨è¿™é“é¢˜é‡Œé¢ï¼Œå¦‚æœdeleteä¹‹åè¿˜æŠŠarray[i]èµ‹å€¼ä¸º0ï¼Œä¸ä»…æ²¡æœ‰æ„ä¹‰ï¼ˆå› ä¸ºå†…å­˜å·²ç»è¢«æ¸…é™¤äº†ï¼‰ï¼Œè€Œä¸”ä¼šå› ä¸ºè°ƒç”¨äº†å¤šæ¬¡Nodeçš„æ‹·è´æ„é€ å‡½æ•°è€Œæµªè´¹äº†æ•ˆç‡ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªå†™æ³•çº¯å±æµªè´¹æ•ˆç‡ï¼Œè¿˜æœ‰é”™è¯¯ã€‚åœ¨delete[]array;è¯­å¥åï¼Œå¦‚æœæƒ³è¿›è¡Œèµ‹å€¼ä¸º0çš„æ“ä½œï¼Œarrayè¦é‡æ–°ç”³è¯·æŒ‡å‘ä¸€å—å†…å­˜ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">Vector&amp;Vector::<span class="keyword">operator</span>=(<span class="keyword">const</span>Â Vector&amp;Â other)</span><br><span class="line">&#123;	<span class="keyword">if</span>Â (<span class="keyword">this</span>Â !=Â &amp;other)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (<span class="keyword">this</span>-&gt;arrayÂ !=Â <span class="literal">nullptr</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â &#123;<span class="keyword">delete</span>[]array;&#125;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â (<span class="keyword">int</span>Â iÂ =Â <span class="number">0</span>;Â iÂ &lt;Â capacity;Â i++)</span><br><span class="line">Â Â Â Â Â Â Â Â &#123;array[i]Â =Â <span class="number">0</span>;&#125;......&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-2-Deleteçš„æ£€æµ‹"><a href="#6-2-Deleteçš„æ£€æµ‹" class="headerlink" title="6.2  Deleteçš„æ£€æµ‹"></a>6.2  Deleteçš„æ£€æµ‹</h2><p>å»ºè®®åœ¨deleteå‰æ£€æµ‹æŒ‡é’ˆæ˜¯å¦ä¸ºç©ºæŒ‡é’ˆï¼Œå› ä¸ºç©ºæŒ‡é’ˆdeleteä¼šæŠ¥é”™ã€‚</p>
<h2 id="6-3-èµ‹å€¼çš„æ£€æµ‹"><a href="#6-3-èµ‹å€¼çš„æ£€æµ‹" class="headerlink" title="6.3  èµ‹å€¼çš„æ£€æµ‹"></a>6.3  èµ‹å€¼çš„æ£€æµ‹</h2><p>å’Œdeleteç›¸ä¼¼ï¼Œå»ºè®®èµ‹å€¼ä¹Ÿè¦å…ˆè¿›è¡Œæ£€æµ‹ï¼Œé¿å…æµªè´¹æ•ˆç‡</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">Vector&amp;Vector::<span class="keyword">operator</span>=(<span class="keyword">const</span>Â Vector&amp;Â other)</span><br><span class="line">&#123;	Â Â Â <span class="keyword">if</span>Â (<span class="keyword">this</span>Â !=Â &amp;other)Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//å»ºè®®èµ‹å€¼çš„æ—¶å€™æ£€æµ‹æ˜¯å¦ç›¸åŒï¼Œæ£€æµ‹çš„åŸç†æœ¬è´¨ä¸Šå°±æ˜¯æ£€æµ‹åœ°å€æ˜¯å¦ç›¸åŒ</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (<span class="keyword">this</span>-&gt;arrayÂ !=Â <span class="literal">nullptr</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â &#123; <span class="keyword">delete</span>[]array; &#125;......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ä¸ƒã€move-ä¸ç±»å‹è½¬æ¢"><a href="#ä¸ƒã€move-ä¸ç±»å‹è½¬æ¢" class="headerlink" title="ä¸ƒã€move ä¸ç±»å‹è½¬æ¢"></a>ä¸ƒã€move ä¸ç±»å‹è½¬æ¢</h1><p>è¯¥éƒ¨åˆ†ä¸ºç¬¬ä¸‰æ¬¡ä½œä¸šç¬¬äºŒé¢˜çš„è§£æï¼Œå»ºè®®ç»“åˆé˜…è¯»</p>
<hr>
<h2 id="7-1-move-çš„æ„ä¹‰"><a href="#7-1-move-çš„æ„ä¹‰" class="headerlink" title="7.1  move çš„æ„ä¹‰"></a>7.1  move çš„æ„ä¹‰</h2><p>moveçš„ä½œç”¨å°±æ˜¯ä»…ä»…æŠŠå·¦å³å€¼è¿™ä¸ªå±æ€§æ”¹ä¸ºå³å€¼ï¼Œå…¶ä½™çš„å±æ€§ä¸å˜ã€‚</p>
<h2 id="7-2-ä¾‹å­"><a href="#7-2-ä¾‹å­" class="headerlink" title="7.2  ä¾‹å­"></a>7.2  ä¾‹å­</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">TestÂ <span class="title">F</span><span class="params">(<span class="keyword">const</span>Â Test&amp;Â a)</span></span>&#123;</span><br><span class="line">Â Â Â Â TestÂ bÂ =Â std::<span class="built_in">move</span>(a);</span><br><span class="line"><span class="keyword">return</span>Â b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â TestÂ AÂ =Â <span class="built_in">F</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªåœ°æ–¹æå…¶æœ‰è¶£çš„æ˜¯Få‡½æ•°ä½“å†…å¯¹bçš„æ„é€ æ˜¯é‡‡ç”¨äº†æ‹·è´æ„é€ è€Œéç§»åŠ¨æ„é€ ã€‚</p>
<p>è¿™æ˜¯ç”±äºmoveå’Œconstçš„åŒé‡ä½œç”¨ã€‚å¦‚åŒå‰æ–‡æ‰€è¿°ï¼Œmoveä¸€å®šå¯ä»¥æŠŠä»»æ„å¯¹è±¡è°ƒæ•´ä¸ºå³å€¼ï¼Œä¸ç®¡æ˜¯ä¸æ˜¯constã€‚</p>
<p>æ·±å±‚æ¬¡åœ°è¯´ï¼Œå˜é‡å‚¨å­˜åœ¨å†…å­˜é‡Œçš„æ—¶å€™å­˜çš„éƒ½æ˜¯å®ƒçš„æ•°æ®ï¼Œè€Œä¸ä¼šä¸“é—¨å¼€è¾Ÿä¸€å—ç©ºé—´æ¥è¯´æ˜å®ƒæ˜¯ä¸æ˜¯constï¼Œæ˜¯ä¸æ˜¯&amp;ç­‰ï¼Œconstå’Œ&amp;è¿™äº›â€œç±»å‹â€æ˜¯ç”±ç¼–è¯‘å™¨æ¥å¤„ç†çš„ã€‚</p>
<p>æˆ‘ä»¬è¯´ç±»å‹è½¬æ¢ï¼ŒæŒ‡çš„å°±æ˜¯æ”¹å˜ç±»å‹ï¼Œè€Œä¸å˜åŠ¨å®ƒåœ¨å†…å­˜é‡Œçš„å‚¨å­˜å½¢å¼ã€‚æ¯”å¦‚ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒåœ¨å†…å­˜é‡Œå­˜çš„å°±æ˜¯ä¸€ä¸²æ•°å­—è¡¨ç¤ºåœ°å€ï¼Œæˆ‘ä»¬çœ‹å®ƒçš„å†…å­˜æƒ…å†µæ—¶ï¼Œå®Œå…¨å¯ä»¥æŠŠè¿™å—å†…å­˜å½“åšå­˜çš„æ˜¯ä¸€ä¸ªæ•´å‹å˜é‡ã€‚æˆ‘ä»¬å¼ºè¡ŒæŠŠæŒ‡é’ˆå½“åšæ•´å‹å˜é‡æ¥çœ‹çš„æ—¶å€™å°±æ˜¯è¿›è¡Œäº†ä¸€ä¸ªç±»å‹è½¬æ¢ã€‚</p>
<p>æ‰€ä»¥std::move(a)è¿™ä¸ªè¡¨è¾¾å¼çš„ç±»å‹å°±æ˜¯const&amp;&amp;ï¼Œå› ä¸ºå®ƒå‘ç”Ÿäº†ç±»å‹è½¬æ¢ã€‚è€Œè½¬æ¢ä¹‹åï¼Œaè½¬ä¸ºconst&amp;&amp;ï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¸é‡å³å€¼å¼•ç”¨ï¼ŒC++å›ºå®šå…¶åªèƒ½å¤Ÿè¢«const&amp;ç»‘å®šã€‚æ•…è€Œåœ¨æ„é€ å‡½æ•°é‡è½½çš„æƒ…å†µä¸‹è°ƒç”¨äº†ç›¸åº”const&amp;çš„æ‹·è´æ„é€ å‡½æ•°ã€‚</p>
<h2 id="7-3-è¿›ä¸€æ­¥è®¨è®º"><a href="#7-3-è¿›ä¸€æ­¥è®¨è®º" class="headerlink" title="7.3  è¿›ä¸€æ­¥è®¨è®º"></a>7.3  è¿›ä¸€æ­¥è®¨è®º</h2><p><img src="https://s2.loli.net/2022/01/11/DsEUd8jN6yZuRoh.png" alt="https://s2.loli.net/2022/01/11/DsEUd8jN6yZuRoh.png"></p>
<p>è¿™å¼ è¡¨ç»™å‡ºäº†å…³äºç»‘å®šå’Œå·¦å³å€¼çš„å…³ç³»ã€‚å·¦è¾¹çš„ä¸€åˆ—æ˜¯å‚æ•°çš„å±æ€§ï¼ŒLvalueæ˜¯æŒ‡å·¦å€¼ï¼Œrvalueæ˜¯æŒ‡å³å€¼ï¼Œconstæ˜¯æŒ‡å¸¸é‡ã€‚ä¸Šæ–¹ä¸€è¡Œç»™å‡ºäº†èƒ½å¤Ÿç»‘å®šçš„ç±»å‹ã€‚è€Œè¡¨ä¸­çš„æ¬¡åºä»£è¡¨å¤šç§ç»‘å®šæ—¶çš„ä¼˜å…ˆçº§ã€‚ä»è€Œå¯è§ï¼Œå¸¸é‡å³å€¼ä¼˜å…ˆåœ¨æˆ‘ä»¬çš„ä¸¤ä¸ªæ„é€ å‡½æ•°å½“ä¸­åªèƒ½ç»‘å®šconst&amp;ã€‚ï¼ˆå› ä¸ºæ²¡æœ‰const&amp;&amp;ç±»å‹çš„é‡è½½ï¼Œæ•…è€Œç»‘å®šçš„æ˜¯ï¼‰ä»è€Œè°ƒç”¨äº†æ‹·è´æ„é€ å‡½æ•°ã€‚</p>
<h1 id="å…«ã€ç½®ç©ºæ€§è®¨è®º"><a href="#å…«ã€ç½®ç©ºæ€§è®¨è®º" class="headerlink" title="å…«ã€ç½®ç©ºæ€§è®¨è®º"></a>å…«ã€ç½®ç©ºæ€§è®¨è®º</h1><h2 id="8-0-ææ„ç½®ç©º"><a href="#8-0-ææ„ç½®ç©º" class="headerlink" title="8.0  ææ„ç½®ç©º"></a>8.0  ææ„ç½®ç©º</h2><p>ææ„å‡½æ•°éœ€è¦å°†æˆå‘˜æ•°æ®ä¸­çš„æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´ç½®ç©ºï¼ˆdeleteï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">Vector::~<span class="built_in">Vector</span>()</span><br><span class="line">&#123;<span class="keyword">if</span>Â (arrayÂ !=Â <span class="literal">nullptr</span>)Â &#123;Â <span class="keyword">delete</span>[]array;Â &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸‹æ–‡ä»¥A=Bä¸ºä¾‹ï¼Œè®¨è®ºèµ‹å€¼è¿‡ç¨‹ä¸­çš„ç½®ç©ºæ€§</p>
<h2 id="8-1-ç§»åŠ¨ç½®ç©º"><a href="#8-1-ç§»åŠ¨ç½®ç©º" class="headerlink" title="8.1  ç§»åŠ¨ç½®ç©º"></a>8.1  ç§»åŠ¨ç½®ç©º</h2><ul>
<li>æ¯æ¬¡ç§»åŠ¨æ—¶ï¼Œæˆ‘ä»¬å°†Bå®Œå…¨ç½®ç©ºä½†æ˜¯ä¸deleteã€‚</li>
</ul>
<h3 id="8-1-1-ç§»åŠ¨å’Œæ‹·è´çš„è¯­ä¹‰åŒºåˆ«"><a href="#8-1-1-ç§»åŠ¨å’Œæ‹·è´çš„è¯­ä¹‰åŒºåˆ«" class="headerlink" title="8.1.1  ç§»åŠ¨å’Œæ‹·è´çš„è¯­ä¹‰åŒºåˆ«"></a>8.1.1  ç§»åŠ¨å’Œæ‹·è´çš„è¯­ä¹‰åŒºåˆ«</h3><p>ç§»åŠ¨å’Œæ‹·è´çš„è¯­ä¹‰åŒºåˆ«åœ¨äºï¼Œè¢«æ‹·è´çš„å¯¹è±¡ä¹‹åè¿˜å¯èƒ½ä¼šè¢«ä½¿ç”¨çš„ï¼Œè€Œè¢«ç§»åŠ¨çš„å¯¹è±¡å¿…é¡»ç½®ç©ºï¼ˆä½†ä¸æ˜¯deleteï¼Œdeleteå‡ºç°åœ¨èµ‹å€¼ç½®ç©ºå’Œææ„ç½®ç©ºå½“ä¸­ï¼‰ã€‚å› ä¸ºç§»åŠ¨çš„æœ¬è´¨åŸç†æ˜¯æŠŠå¯¹åŒä¸€å—å†…å­˜ç©ºé—´æ›´æ¢ä¸ºæ–°æŒ‡é’ˆï¼Œå¹¶ä¸”å°†åŸæŒ‡é’ˆç½®ç©ºã€‚</p>
<h3 id="8-1-2-ç§»åŠ¨å’Œæ‹·è´çš„åŸç†åŒºåˆ«"><a href="#8-1-2-ç§»åŠ¨å’Œæ‹·è´çš„åŸç†åŒºåˆ«" class="headerlink" title="8.1.2 ç§»åŠ¨å’Œæ‹·è´çš„åŸç†åŒºåˆ«"></a>8.1.2 ç§»åŠ¨å’Œæ‹·è´çš„åŸç†åŒºåˆ«</h3><p>8.1.2.1æ‹·è´çš„åŸç†</p>
<p>Aä¸Bå„è‡ªæœ‰ä¸€ä¸ªæŒ‡é’ˆï¼Œå¦‚æœAï¼=Bæ—¶ï¼Œä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸¤å—ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ã€‚ï¼ˆA=Bæ—¶æ— éœ€æ‹·è´ï¼‰ç°å°†Aå†…å­˜ç©ºé—´é‡Œæ‰€æœ‰æ•°æ®æ¸…é™¤ï¼ˆä¸ºä»€ä¹ˆè¦æ¸…é™¤åœ¨2.2.1è¿›è¡Œäº†è§£é‡Šï¼‰ï¼Œæ¥ç€æŠŠBçš„å†…å­˜ç©ºé—´å†…æ‰€æœ‰æ•°æ®ä¼ é€’ç»™Açš„å†…å­˜ç©ºé—´ã€‚è¿™ä¸€ä¼ é€’è¿‡ç¨‹ä¸ä¼šç ´åBçš„æ•°æ®ï¼Œä½†æ˜¯æ•ˆç‡è¾ƒä½ã€‚</p>
<p>8.1.2.2ç§»åŠ¨çš„åŸç†</p>
<p>Aä¸Bå„è‡ªæœ‰ä¸€ä¸ªæŒ‡é’ˆã€‚å¦‚æœAï¼=Bæ—¶ï¼Œä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸¤å—ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ã€‚ï¼ˆA=Bæ—¶æ— éœ€ç§»åŠ¨ï¼‰å¦‚æœæ­¤æ—¶Açš„æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´ä¸ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯AæŒ‡é’ˆä¸ä¸ºç©ºæŒ‡é’ˆï¼Œé‚£ä¹ˆå°†Açš„æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´é€šè¿‡deleteæ¸…é™¤ï¼ŒAæŒ‡é’ˆå³è½¬ä¸ºç©ºæŒ‡é’ˆã€‚å°†Bçš„æŒ‡é’ˆèµ‹å€¼ç»™Açš„æŒ‡é’ˆï¼Œå¹¶å°†BæŒ‡é’ˆç½®ä¸ºç©ºæŒ‡é’ˆã€‚è¿™ä¸€è¿‡ç¨‹å®é™…ä¸Šæ˜¯æ”¹å˜äº†å†…å­˜ç©ºé—´çš„æŒ‡é’ˆä½†æ˜¯æ²¡æœ‰æ”¹å˜å†…å­˜ç©ºé—´ã€‚</p>
<h3 id="8-1-3-ç§»åŠ¨è¿‡ç¨‹ä¸­BæŒ‡é’ˆç½®ç©º"><a href="#8-1-3-ç§»åŠ¨è¿‡ç¨‹ä¸­BæŒ‡é’ˆç½®ç©º" class="headerlink" title="8.1.3  ç§»åŠ¨è¿‡ç¨‹ä¸­BæŒ‡é’ˆç½®ç©º"></a>8.1.3  ç§»åŠ¨è¿‡ç¨‹ä¸­BæŒ‡é’ˆç½®ç©º</h3><p>åœ¨ææ„å‡½æ•°é‡Œï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨deleteã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">Vector::~<span class="built_in">Vector</span>()</span><br><span class="line">&#123;<span class="keyword">if</span>Â (arrayÂ !=Â <span class="literal">nullptr</span>)Â &#123;Â <span class="keyword">delete</span>[]array;Â &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>å€˜è‹¥ä¸æŠŠBæŒ‡é’ˆç½®ç©ºï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šææ„deleteä¸€æ¬¡BæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼Œç„¶è€ŒAæŒ‡é’ˆä¸ä¸ºç©ºã€‚åœ¨ææ„æ—¶ï¼Œåˆå°†å¯¹åŒä¸€ä¸ªå†…å­˜ç©ºé—´deleteä¸€æ¬¡ã€‚Deleteä¸€ç©ºçš„ç©ºé—´æ˜¯ä¸å…è®¸çš„ã€‚æ•…è€Œç§»åŠ¨æ„é€ å¿…ç„¶è¦å°†BæŒ‡é’ˆç½®ç©ºä»¥é¿å…å¤šæ¬¡deleteåŒä¸€ç©ºé—´ã€‚è¿™æ ·ä¹Ÿå¯¼è‡´äº†BæŒ‡é’ˆä¸èƒ½å†æ¬¡ä½¿ç”¨ï¼ˆæ•´ä¸ªBæ— æ³•å†å»èµ‹å€¼ï¼‰ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆç§»åŠ¨æ„é€ å¿…ç„¶è¦ç ´åç”¨æ¥æ„é€ çš„å¯¹è±¡ï¼šå› ä¸ºä¸èƒ½å‡ºç°ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€å—ç©ºé—´çš„æƒ…å†µã€‚</p>
<p>åŒæ ·çš„ï¼Œä¸ºäº†æ¨¡æ‹Ÿè¿™ç§å¯¹BæŒ‡é’ˆçš„ç ´åæ€§ï¼Œåœ¨ç¬¬ä¸‰éƒ¨åˆ†æŠ€æœ¯ç»†èŠ‚é‡ŒæåŠäº†Nodeçš„ç§»åŠ¨æ„é€ æœºåˆ¶ã€‚è¿™ä¸€æœºåˆ¶ä¹Ÿå°†â€œBæŒ‡é’ˆâ€ï¼ˆå®é™…ä¸Šæ˜¯åŸæ¥çš„intï¼‰ç½®ç©ºï¼Œæ•…è€Œè¢«ç§»åŠ¨äº†çš„Nodeä¹Ÿæ˜¯æ²¡æ³•å†æ¬¡åˆ©ç”¨çš„ã€‚</p>
<h3 id="8-1-4-ç§»åŠ¨è¿‡ç¨‹ä¸­Bå®Œå…¨ç½®ç©º"><a href="#8-1-4-ç§»åŠ¨è¿‡ç¨‹ä¸­Bå®Œå…¨ç½®ç©º" class="headerlink" title="8.1.4 ç§»åŠ¨è¿‡ç¨‹ä¸­Bå®Œå…¨ç½®ç©º"></a>8.1.4 ç§»åŠ¨è¿‡ç¨‹ä¸­Bå®Œå…¨ç½®ç©º</h3><p>æˆ‘ä»¬åœ¨ä¸Šæ–‡å·²ç»å™è¿°äº†ä¸ºä»€ä¹ˆéœ€è¦å°†BæŒ‡é’ˆç½®ç©ºã€‚å®é™…ä¸Šï¼Œç”±äºBå¯¹è±¡è¢«ç§»åŠ¨ä¹‹åå·²ç»ä¸å†æ¬¡ä½¿ç”¨ï¼Œéœ€è¦å°†å…¶å®Œå…¨ç½®ç©ºï¼ˆæ‰€æœ‰çš„æˆå‘˜æ•°æ®éƒ½è¦ç½®ç©ºï¼Œè€Œä¸åªæ˜¯Bé‡Œé¢çš„æŒ‡é’ˆå¯¹è±¡ï¼‰ï¼Œä»è€Œé¿å…å†…å­˜æ³„æ¼ã€‚ï¼ˆè¿™é‡Œç‚¹åˆ°ä¸ºæ­¢ï¼Œå…·ä½“çš„ç»†èŠ‚å‚è§ç¬¬ä¸‰éƒ¨åˆ†ï¼‰</p>
<h2 id="8-2-èµ‹å€¼ç½®ç©º"><a href="#8-2-èµ‹å€¼ç½®ç©º" class="headerlink" title="8.2  èµ‹å€¼ç½®ç©º"></a>8.2  èµ‹å€¼ç½®ç©º</h2><ul>
<li>Defæ¯æ¬¡èµ‹å€¼æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡deleteå°†Aç½®ç©º</li>
</ul>
<h3 id="8-2-1-æ‹·è´èµ‹å€¼"><a href="#8-2-1-æ‹·è´èµ‹å€¼" class="headerlink" title="8.2.1  æ‹·è´èµ‹å€¼"></a>8.2.1  æ‹·è´èµ‹å€¼</h3><p>æ‹·è´èµ‹å€¼æ—¶ï¼Œæ£€æµ‹å®ŒA==Båï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨deleteå°†Aç½®ç©ºã€‚</p>
<p>è¿™é‡Œä¸ºä»€ä¹ˆè¦å…ˆæ¸…é™¤Açš„åŸå†…å­˜ç©ºé—´ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬çš„ç§»åŠ¨èµ‹å€¼éœ€è¦äºŒè€…èµ‹å€¼å®Œåå®Œå…¨ç›¸åŒï¼Œå¦‚æœAåŸå†…å­˜ç©ºé—´è¶…å‡ºBçš„é‚£éƒ¨åˆ†å®¹ç§¯æœ‰å¤šäºå†…å®¹ï¼Œä¸æ¸…é™¤å°†Aåˆ™æ— æ³•ä½¿å¾—Aä¸Bå®Œå…¨ç›¸åŒã€‚å…¶æ¬¡ï¼Œä¸æ¸…é™¤æ›´å¤§çš„é—®é¢˜æ˜¯å†…å­˜æ³„éœ²ä¸¥é‡ã€‚</p>
<p>æ³¨æ„åˆ°æ‹·è´èµ‹å€¼ç°å°†Açš„å†…å­˜ç©ºé—´deleteä¹‹åï¼ŒAçš„æŒ‡é’ˆéœ€è¦æŒ‡å‘ä¸€å—å†…å­˜ç©ºé—´æ‰èƒ½ä½¿Aæ¥å—Bçš„æ‹·è´èµ‹å€¼ã€‚æ•…éœ€è¦ç”³è¯·æ–°çš„å†…å­˜ç©ºé—´ã€‚ï¼ˆä¸Bçš„å†…å­˜ç©ºé—´å¤§å°å®Œå…¨ç›¸åŒï¼‰</p>
<h3 id="8-2-2-ç§»åŠ¨èµ‹å€¼"><a href="#8-2-2-ç§»åŠ¨èµ‹å€¼" class="headerlink" title="8.2.2  ç§»åŠ¨èµ‹å€¼"></a>8.2.2  ç§»åŠ¨èµ‹å€¼</h3><p>ç»¼åˆå‰æ–‡æ‰€è¿°ï¼Œç§»åŠ¨éœ€è¦å°†Bå®Œå…¨ç½®ç©ºä½†æ˜¯ä¸deleteï¼Œè€Œèµ‹å€¼éœ€è¦å°†Aé€šè¿‡deleteç½®ç©ºä¹‹åå†æ¬¡ç”³è¯·æ–°çš„ç©ºé—´ã€‚æ‰€ä»¥ç”¨Bç§»åŠ¨èµ‹å€¼Açš„æ—¶å€™éœ€è¦ä¸¤æ¬¡ç½®ç©ºï¼Œä¸€æ¬¡deleteï¼ˆå¯¹Açš„ï¼‰è€Œå¦ä¸€æ¬¡ä¸deleteï¼ˆå¯¹Bçš„ï¼‰ã€‚</p>
<h1 id="ä¹ã€ç±»å‹è½¬æ¢"><a href="#ä¹ã€ç±»å‹è½¬æ¢" class="headerlink" title="ä¹ã€ç±»å‹è½¬æ¢"></a>ä¹ã€ç±»å‹è½¬æ¢</h1><h2 id="9-1-æ„ä¹‰"><a href="#9-1-æ„ä¹‰" class="headerlink" title="9.1  æ„ä¹‰"></a>9.1  æ„ä¹‰</h2><p>å½“ç¼–è¯‘å™¨å‘ç°è¡¨è¾¾å¼å’Œå‡½æ•°è°ƒç”¨æ‰€éœ€çš„æ•°æ®ç±»å‹å’Œå®é™…ç±»å‹ä¸åŒæ—¶ï¼Œä¾¿ä¼šè¿›è¡Œè‡ªåŠ¨ç±»å‹è½¬æ¢ã€‚</p>
<p>è‡ªåŠ¨ç±»å‹è½¬æ¢å¯é€šè¿‡å®šä¹‰ç‰¹å®šçš„<strong>è½¬æ¢è¿ç®—ç¬¦</strong>å’Œ<strong>æ„é€ å‡½æ•°</strong>æ¥å®Œæˆã€‚</p>
<p>é™¤è‡ªåŠ¨ç±»å‹è½¬æ¢å¤–ï¼Œåœ¨æœ‰å¿…è¦çš„æ—¶å€™è¿˜å¯ä»¥è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">print</span><span class="params">(<span class="keyword">int</span>Â d)</span>Â </span>&#123;Â &#125;Â </span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Â Â Â Â <span class="built_in">print</span>(<span class="number">3.5</span>);</span><br><span class="line">Â Â Â Â <span class="built_in">print</span>(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="9-2-è¯­æ³•"><a href="#9-2-è¯­æ³•" class="headerlink" title="9.2  è¯­æ³•"></a>9.2  è¯­æ³•</h2><p>æ–¹æ³•ä¸€ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Dst</span>Â &#123;</span>Â <span class="comment">//ç›®æ ‡ç±»Destination</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â <span class="built_in">Dst</span>()Â &#123;Â coutÂ &lt;&lt;Â <span class="string">&quot;Dst::Dst()&quot;</span>Â &lt;&lt;Â endl;Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Src</span>Â &#123;</span>Â <span class="comment">//æºç±»Source</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â <span class="built_in">Src</span>()Â &#123;Â coutÂ &lt;&lt;Â <span class="string">&quot;Src::Src()&quot;</span>Â &lt;&lt;Â endl;Â &#125;</span><br><span class="line">Â Â <span class="function"><span class="keyword">operator</span>Â <span class="title">Dst</span><span class="params">()</span>Â <span class="keyword">const</span>Â </span>&#123;Â </span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Src::operatorÂ Dst()Â called&quot;</span>Â &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="built_in">Dst</span>();Â </span><br><span class="line">Â Â &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>åœ¨æºç±»ä¸­å®šä¹‰â€œæºç±»ä¸­é‡è½½ç›®æ ‡ç±»å‹è½¬æ¢è¿ç®—ç¬¦â€</p>
<p>æ³¨æ„ï¼šä¸éœ€è¦æŒ‡å®šè¿”å›ç±»å‹ï¼Œå› ä¸ºoperatoråDst()å·²ç»æŒ‡æ˜ï¼Œè¿”å›å€¼æ˜¯Dst()ï¼Œè¿”å›å‡½æ•°åæ•…è€Œä¸éœ€è¦è¿”å›ç±»å‹ã€‚è¿™æ˜¯ç±»å‹è½¬æ¢çš„å›ºå®šè¯­æ³•ï¼Œå¦‚åŒæ„é€ å‡½æ•°ä¸éœ€è¦å°±å¥½ã€‚</p>
<p>æ–¹æ³•äºŒï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Src</span>;</span>Â Â <span class="comment">//Â å‰ç½®ç±»å‹å£°æ˜ï¼Œå› ä¸ºåœ¨Dstä¸­è¦ç”¨åˆ°Srcç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Dst</span>Â &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â <span class="built_in">Dst</span>()Â &#123;Â coutÂ &lt;&lt;Â <span class="string">&quot;Dst::Dst()&quot;</span>Â &lt;&lt;Â endl;Â &#125;</span><br><span class="line">Â Â <span class="built_in">Dst</span>(<span class="keyword">const</span>Â Src&amp;Â s)Â &#123;Â </span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Dst::Dst(constÂ Src&amp;)&quot;</span>Â &lt;&lt;Â endl;Â </span><br><span class="line">Â Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Src</span>Â &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â <span class="built_in">Src</span>()Â &#123;Â coutÂ &lt;&lt;Â <span class="string">&quot;Src::Src()&quot;</span>Â &lt;&lt;Â endl;Â &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>åœ¨ç›®æ ‡ç±»ä¸­å®šä¹‰â€œç›®æ ‡ç±»ä¸­å®šä¹‰æºç±»å¯¹è±¡ä½œå‚æ•°çš„æ„é€ å‡½æ•°â€ã€‚</p>
<p>ä¸¤ç§æ–¹æ³•ä»»é€‰ä¸€ç§å³å¯è¿è¡Œã€‚<br>ä½†æ˜¯ä¸€å®šè¦æ³¨æ„åŒºåˆ†ä¸¤ç§è½¬æ¢æ–¹å¼ï¼Œå¦‚æœæ²¡æœ‰åšåŒºåˆ†ï¼Œå¸¸å¸¸ä¼šå¯¼è‡´è½¬æ¢æ–¹å‘é”™è¯¯ã€‚æ­¤å¤–ï¼Œä¸¤ç§è‡ªåŠ¨ç±»å‹è½¬æ¢çš„æ–¹æ³•ä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼Œä½¿ç”¨æ—¶å¿…é¡»ä»»é€‰å…¶ä¸­ä¸€ç§ã€‚</p>
<h2 id="9-3-ä¾‹å­"><a href="#9-3-ä¾‹å­" class="headerlink" title="9.3  ä¾‹å­"></a>9.3  ä¾‹å­</h2><p>ä¾‹1ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Dst</span>Â &#123;</span>Â <span class="comment">//ç›®æ ‡ç±»Destination</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â <span class="built_in">Dst</span>()Â &#123;Â coutÂ &lt;&lt;Â <span class="string">&quot;Dst::Dst()&quot;</span>Â &lt;&lt;Â endl;Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Src</span>Â &#123;</span>Â <span class="comment">//æºç±»Source</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â <span class="built_in">Src</span>()Â &#123;Â coutÂ &lt;&lt;Â <span class="string">&quot;Src::Src()&quot;</span>Â &lt;&lt;Â endl;Â &#125;</span><br><span class="line">Â Â <span class="function"><span class="keyword">operator</span>Â <span class="title">Dst</span><span class="params">()</span>Â <span class="keyword">const</span>Â </span>&#123;Â </span><br><span class="line">Â Â Â Â coutÂ &lt;&lt;Â <span class="string">&quot;Src::operatorÂ Dst()Â called&quot;</span>Â &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="built_in">Dst</span>();Â </span><br><span class="line">Â Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">Transform</span><span class="params">(DstÂ d)</span>Â </span>&#123;Â &#125;Â </span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Â Â SrcÂ s;</span><br><span class="line">Â Â <span class="function">DstÂ <span class="title">d1</span><span class="params">(s)</span></span>;</span><br><span class="line">Â Â DstÂ d2Â =Â s;Â </span><br><span class="line">Â Â <span class="built_in">Transform</span>(s);Â </span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">outputï¼š</span><br><span class="line">Src::<span class="built_in">Src</span>()</span><br><span class="line"><span class="function">Src::<span class="keyword">operator</span>Â <span class="title">Dst</span><span class="params">()</span>Â called</span></span><br><span class="line"><span class="function"><span class="title">Dst::Dst</span><span class="params">()</span></span></span><br><span class="line"><span class="function">Src::<span class="keyword">operator</span>Â <span class="title">Dst</span><span class="params">()</span>Â called</span></span><br><span class="line"><span class="function"><span class="title">Dst::Dst</span><span class="params">()</span></span></span><br><span class="line"><span class="function">Src::<span class="keyword">operator</span>Â <span class="title">Dst</span><span class="params">()</span>Â called</span></span><br><span class="line"><span class="function"><span class="title">Dst::Dst</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°å¼ºåˆ¶ç±»å‹è½¬æ¢å¹¶ä¸ä¼šå‘ç”Ÿç±»ä¼¼åˆ‡ç‰‡çš„æ•ˆæœï¼Œåªæ˜¯ç”¨æŸä¸€ä¸ªç±»å‹ç”Ÿæˆäº†å¦ä¸€ç±»å‹è€Œå·²ã€‚è¿™é‡Œä¸»å‡½æ•°å†…Dst d2 = s;ç­‰ä»·äºDst d2(s)ï¼›è€Œ<code>void Transform(Dst d);</code>è°ƒç”¨çš„å‚æ•°æœ¬è¯¥æ˜¯Dstç±»å‹ï¼Œç”±äºå®šä¹‰äº†ä»såˆ°Dstçš„ç±»å‹è½¬æ¢ï¼Œæ•…è€Œä¹Ÿå¯ä»¥æ‰§è¡Œï¼Œå¹¶è¿›è¡Œäº†è½¬æ¢ã€‚</p>
<p>ä¾‹2ï¼šå¯»æ‰¾é”™è¯¯</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">SmallInt</span>;</span></span><br><span class="line"><span class="function"><span class="keyword">operator</span>Â <span class="title">int</span><span class="params">(SmallInt&amp;)</span></span>;Â <span class="comment">//é”™è¯¯ï¼šä¸æ˜¯æˆå‘˜å‡½æ•°ï¼›æ— è®ºå“ªç§è½¬æ¢æ–¹å¼ï¼Œéƒ½æ˜¯å®šä¹‰åœ¨ç±»å†…çš„æˆå‘˜å‡½æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">SmallInt</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">int</span>Â <span class="keyword">operator</span>Â <span class="title">int</span><span class="params">()</span>Â <span class="keyword">const</span></span>;Â Â Â </span><br><span class="line"><span class="comment">//é”™è¯¯ï¼šä¸èƒ½è¿”å›ç±»å‹Â </span></span><br><span class="line"><span class="function"><span class="keyword">operator</span>Â <span class="title">int</span><span class="params">(<span class="keyword">int</span>Â =Â <span class="number">0</span>)</span>Â <span class="keyword">const</span></span>;Â <span class="comment">//é”™è¯¯ï¼šåœ¨æºç±»ä¸­å®šä¹‰ç›®æ ‡ç±»çš„é‡è½½è¿ç®—ç¬¦éœ€è¦å‚æ•°åˆ—è¡¨ä¸ºç©º</span></span><br><span class="line"><span class="keyword">operator</span>Â <span class="keyword">int</span>*()Â <span class="keyword">const</span>Â &#123;<span class="keyword">return</span>Â <span class="number">42</span>;&#125;Â </span><br><span class="line"><span class="comment">//é”™è¯¯ï¼š42ä¸æ˜¯ä¸€ä¸ªåˆæ³•æŒ‡é’ˆ,æœ¬æ„ï¼šå°†SmallIntå¯¹è±¡è½¬æ¢ä¸ºint*Â æŒ‡é’ˆ</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä¾‹3ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">SmallInt</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â Â Â <span class="built_in">SmallInt</span>Â (<span class="keyword">int</span>Â i=<span class="number">0</span>):Â <span class="built_in">val</span>(i)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â cout&lt;&lt;<span class="string">&quot;SmallInt_Init&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ„é€ å‡½æ•°:ä»¥intä¸ºå‚æ•°çš„SmallIntæ„é€ å‡½æ•°ï¼Œä»è€Œå°†intè½¬æ¢ä¸ºSmallInt</span></span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">operator</span>Â <span class="title">int</span><span class="params">()</span>Â <span class="keyword">const</span>Â </span>&#123;Â </span><br><span class="line">Â Â Â Â Â Â Â Â cout&lt;&lt;<span class="string">&quot;Int_Transform&quot;</span>&lt;&lt;endl;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â val;Â </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è½¬æ¢è¿ç®—ç¬¦:ä»SmallIntè½¬æ¢ä¸ºintï¼›åœ¨æºç±»ä¸­å®šä¹‰â€œç›®æ ‡ç±»å‹è½¬æ¢è¿ç®—ç¬¦â€</span></span><br><span class="line"><span class="comment">//æ³¨æ„åˆ°è¿™ä¸ªä¾‹å­æ—¢æœ‰intåˆ°smallintçš„è½¬æ¢ï¼Œä¹Ÿæœ‰smallintåˆ°intçš„è½¬æ¢ã€‚</span></span><br><span class="line"><span class="comment">//smallintæ—¢åšäº†æºç±»ï¼Œåˆåšäº†ç›®æ ‡ç±»</span></span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">void</span>Â <span class="title">print</span><span class="params">()</span>Â </span>&#123;Â </span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;Â valÂ &lt;&lt;Â endl;Â </span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">Â Â Â Â <span class="keyword">size_t</span>Â val;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Â Â Â Â SmallIntÂ si;</span><br><span class="line">Â Â Â Â si.<span class="built_in">print</span>();</span><br><span class="line">Â Â Â Â siÂ =Â <span class="number">4.10</span>;</span><br><span class="line">Â Â Â Â si.<span class="built_in">print</span>();</span><br><span class="line">Â Â Â Â siÂ =Â siÂ +Â <span class="number">3</span>;</span><br><span class="line">Â Â Â Â si.<span class="built_in">print</span>();</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">output:</span><br><span class="line">SmallInt_Init</span><br><span class="line"><span class="number">0</span></span><br><span class="line">SmallInt_Init</span><br><span class="line"><span class="number">4</span></span><br><span class="line">Int_Transform</span><br><span class="line">SmallInt_Init</span><br><span class="line"><span class="number">7</span></span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œè¿™é‡Œå®šä¹‰çš„valæ˜¯size_tç±»å‹ã€‚å®ƒæ˜¯ä¸€ç§â€œæ•´å‹â€ç±»å‹ï¼Œé‡Œé¢ä¿å­˜çš„æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå°±åƒint, longä¸€æ ·ã€‚è¿™ç§æ•´æ•°ç”¨æ¥è®°å½•ä¸€ä¸ªå¤§å°(size)ã€‚</p>
<p>size_tçš„å…¨ç§°åº”è¯¥æ˜¯size typeï¼Œå°±æ˜¯è¯´â€œä¸€ç§ç”¨æ¥è®°å½•å¤§å°çš„æ•°æ®ç±»å‹â€ã€‚é€šå¸¸æˆ‘ä»¬ç”¨sizeof(XXX)æ“ä½œï¼Œè¿™ä¸ªæ“ä½œæ‰€å¾—åˆ°çš„ç»“æœå°±æ˜¯size_tç±»å‹ã€‚å› ä¸ºsize_tç±»å‹çš„æ•°æ®å…¶å®æ˜¯ä¿å­˜äº†ä¸€ä¸ªæ•´æ•°ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¯ä»¥åšåŠ å‡ä¹˜é™¤ï¼Œä¹Ÿå¯ä»¥è½¬åŒ–ä¸ºintå¹¶èµ‹å€¼ç»™intç±»å‹çš„å˜é‡ã€‚</p>
<p>æ³¨æ„ç¬¬äºŒä¸ªSmallInt_Init;å‡ºç°åœ¨si = 4.10ï¼Œé¦–å…ˆå†…ç½®ç±»å‹è½¬æ¢å°†doubleè½¬æ¢ä¸ºintï¼Œç„¶åè°ƒç”¨æ„é€ å‡½æ•°æ„é€ äº†ä»¥int 4ä¸ºå‚æ•°çš„SmallIntï¼ˆ4ï¼‰ï¼Œéšå¼åœ°å°†4è½¬æ¢æˆSmallIntç±»å‹ã€‚ä¹‹åæŠŠè¿™ä¸ªSmallintï¼ˆ4ï¼‰èµ‹å€¼ç»™Siï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆäº†Smallintçš„èµ‹å€¼è¿ç®—ç¬¦é‡è½½ã€‚</p>
<p><code>si = si + 3ï¼›</code>é¦–å…ˆæ‰§è¡Œsi + 3ï¼Œä¹‹åæ‰§è¡Œèµ‹å€¼è¯­å¥ã€‚</p>
<p>è¿™å¯èƒ½æœ‰ä¸¤ç§æƒ…å†µï¼šæƒ…å†µä¸€ï¼ŒæŠŠsiè½¬ä¸ºintï¼Œç„¶åæ‰§è¡Œintçš„åŠ æ³•ï¼Œå¾—åˆ°7ï¼›å¾—åˆ°7ä¹‹åçš„æ­¥éª¤å³ä¸ºèµ‹å€¼è¯­å¥si=7ï¼Œå’Œä¸Šæ–¹çš„si=4ç±»ä¼¼ã€‚è°ƒç”¨æ„é€ å‡½æ•°æ„é€ äº†ä»¥int 7ä¸ºå‚æ•°çš„SmallIntï¼ˆ7ï¼‰ï¼Œéšå¼åœ°å°†7è½¬æ¢æˆSmallIntç±»å‹ï¼Œä¹‹åå†è°ƒç”¨ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„èµ‹å€¼è¿ç®—ç¬¦é‡è½½ã€‚æƒ…å†µäºŒï¼ŒæŠŠ3è½¬ä¸ºsmallintå†å’Œsiç›¸åŠ ã€‚è¿™å°±æœ‰ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ²¡æœ‰æ˜¾å¼åœ°é‡è½½smallintçš„+è¿ç®—ç¬¦ï¼Œæ•…è€Œæ— æ³•è¿™ä¸ªè½¬æ¢å³æ˜¯å®Œæˆäº†ï¼Œä¹Ÿæ— æ³•ç»§ç»­ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ­¤åŸºç¡€ä¸Šé‡è½½äº†smallintçš„+è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬ä¸ä»…æœ‰smallintè½¬ä¸ºintç„¶åä¸¤ä¸ªintç›¸åŠ å†æ„é€ smallint(7)å†èµ‹å€¼è¿™æ¡è·¯ï¼ŒåŒæ—¶è¿˜æœ‰3åˆ©ç”¨æ„é€ å‡½æ•°éšå¼è½¬ä¸ºsmallintä¹‹åä¸¤ä¸ªsmallintç›¸åŠ ï¼Œå†èµ‹å€¼ç»™siè¿™æ¡è·¯ã€‚ä¼šå‡ºç°è·¯å¾„æ­§ä¹‰è€Œç¼–è¯‘é”™è¯¯ã€‚å¦‚ä½•åªè¿›è¡Œç¬¬äºŒæ¡è·¯ï¼Œæˆ‘ä»¬é€šè¿‡ä¾‹4æ¥å®ç°ã€‚</p>
<p>ä¾‹4ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â std;</span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">SmallInt</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Â Â Â Â <span class="built_in">SmallInt</span>(<span class="keyword">int</span>Â i=<span class="number">0</span>):Â <span class="built_in">val</span>(i)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â cout&lt;&lt;<span class="string">&quot;SmallInt_Init&quot;</span>Â &lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â SmallInt&amp;Â <span class="keyword">operator</span>=(<span class="keyword">const</span>Â SmallIntÂ &amp;src)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(Â <span class="keyword">this</span>Â ==Â &amp;srcÂ )Â <span class="keyword">return</span>Â *<span class="keyword">this</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â coutÂ &lt;&lt;<span class="string">&quot;operator=&quot;</span>&lt;&lt;endl;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">this</span>-&gt;valÂ =Â src.val;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â *<span class="keyword">this</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">SmallIntÂ <span class="keyword">operator</span>+(<span class="keyword">const</span>Â SmallInt&amp;Â b)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â cout&lt;&lt;<span class="string">&quot;operator+&quot;</span>&lt;&lt;Â endl;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="built_in">SmallInt</span>(<span class="keyword">this</span>-&gt;valÂ +Â b.val);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">Â Â Â Â <span class="keyword">size_t</span>Â val;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â SmallIntÂ si;</span><br><span class="line">Â Â Â Â siÂ =Â <span class="number">4.10</span>;</span><br><span class="line">Â Â Â Â siÂ =Â siÂ +Â <span class="number">3</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">outputï¼š</span><br><span class="line">SmallInt_Init</span><br><span class="line">SmallInt_Init</span><br><span class="line"><span class="keyword">operator</span>=</span><br><span class="line">SmallInt_Init</span><br><span class="line"><span class="keyword">operator</span>+</span><br><span class="line">SmallInt_Init</span><br><span class="line"><span class="keyword">operator</span>=</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€ä¾‹å­éªŒè¯äº†ä¹‹å‰çš„ç†è§£ã€‚æˆ‘ä»¬æœ‰äº†si=smallintï¼ˆ4ï¼‰å¯¹åº”çš„=æ‹·è´èµ‹å€¼è¿ç®—ç¬¦é‡è½½çš„è¾“å‡ºã€‚åœ¨si=si+3è¿™ä¸€æ­¥ï¼Œé¦–å…ˆæŠŠ3è½¬ä¸ºäº†smallintï¼ˆ3ï¼‰ï¼Œæ¥ç€åˆ©ç”¨äº†operator+ã€‚æ³¨æ„åˆ°operator+çš„è¿”å›å€¼å†æ¬¡è°ƒç”¨äº†æ„é€ å‡½æ•°ï¼Œæ¥ç€æŠŠè¿”å›å€¼æ‹·è´èµ‹å€¼ç»™siã€‚</p>
<p>ä½†æ˜¯ä¾‹å››æ˜¯å¦‚ä½•é¿å…äº†è·¯å¾„æ­§ä¹‰å‘¢ï¼Ÿæ³¨æ„åˆ°æˆ‘ä»¬åˆ é™¤äº†ä»smallintè½¬ä¸ºintçš„ç±»å‹è½¬æ¢è¿ç®—ç¬¦ï¼Œæ•…è€Œæ²¡æœ‰è·¯å¾„ä¸€ï¼Œåªæœ‰è·¯å¾„äºŒã€‚</p>
<h2 id="9-4-ç¦æ­¢è‡ªåŠ¨ç±»å‹è½¬æ¢"><a href="#9-4-ç¦æ­¢è‡ªåŠ¨ç±»å‹è½¬æ¢" class="headerlink" title="9.4  ç¦æ­¢è‡ªåŠ¨ç±»å‹è½¬æ¢"></a>9.4  ç¦æ­¢è‡ªåŠ¨ç±»å‹è½¬æ¢</h2><p>å¦‚æœç”¨<strong>explicit</strong>ä¿®é¥°ç±»å‹è½¬æ¢è¿ç®—ç¬¦æˆ–ç±»å‹è½¬æ¢æ„é€ å‡½æ•°ï¼Œåˆ™ç›¸åº”çš„ç±»å‹è½¬æ¢å¿…é¡»æ˜¾å¼åœ°è¿›è¡Œã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">explicit</span>Â <span class="keyword">operator</span>Â <span class="title">Dst</span><span class="params">()</span>Â <span class="keyword">const</span></span>;</span><br><span class="line">æˆ–ä½¿ç”¨</span><br><span class="line"><span class="function"><span class="keyword">explicit</span>Â <span class="title">Dst</span><span class="params">(<span class="keyword">const</span>Â Src&amp;Â s)</span></span>;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¾‹1ä¸­å¦‚æœä½¿ç”¨explicitï¼Œé‚£ä¹ˆï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Â Â SrcÂ s;</span><br><span class="line">Â Â <span class="function">DstÂ <span class="title">d1</span><span class="params">(s)</span></span>;Â Â Â Â Â Â Â Â <span class="comment">//å¯ä»¥æ‰§è¡Œï¼Œè¢«è®¤ä¸ºæ˜¯æ˜¾å¼åˆå§‹åŒ–</span></span><br><span class="line">Â Â <span class="comment">//DstÂ d2Â =Â s;Â Â Â Â Â //é”™è¯¯ï¼Œéšå¼è½¬æ¢</span></span><br><span class="line">Â Â <span class="comment">//Transform(s);Â //é”™è¯¯ï¼Œéšå¼è½¬æ¢</span></span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="9-5-å››ç±»å¼ºåˆ¶ç±»å‹è½¬æ¢"><a href="#9-5-å››ç±»å¼ºåˆ¶ç±»å‹è½¬æ¢" class="headerlink" title="9.5  å››ç±»å¼ºåˆ¶ç±»å‹è½¬æ¢"></a>9.5  å››ç±»å¼ºåˆ¶ç±»å‹è½¬æ¢</h2><p>const_castï¼Œå»é™¤ç±»å‹çš„constæˆ–volatileå±æ€§ã€‚<br>static_castï¼Œç±»ä¼¼äºCé£æ ¼çš„å¼ºåˆ¶è½¬æ¢ã€‚æ— æ¡ä»¶è½¬æ¢ï¼Œé™æ€ç±»å‹è½¬æ¢ã€‚<br>dynamic_castï¼ŒåŠ¨æ€ç±»å‹è½¬æ¢ï¼Œå¦‚æ´¾ç”Ÿç±»å’ŒåŸºç±»ä¹‹é—´çš„å¤šæ€ç±»å‹è½¬æ¢ã€‚<br>reinterpret_castï¼Œä»…ä»…é‡æ–°è§£é‡Šç±»å‹ï¼Œä½†æ²¡æœ‰è¿›è¡ŒäºŒè¿›åˆ¶çš„è½¬æ¢ã€‚</p>
<p>ä¹‹å‰çš„ä¾‹å­é‡å†™ä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Â Â SrcÂ s;</span><br><span class="line">Â Â <span class="function">DstÂ <span class="title">d1</span><span class="params">(s)</span></span>;</span><br><span class="line"></span><br><span class="line">Â Â DstÂ d2Â =Â <span class="keyword">static_cast</span>&lt;Dst&gt;(s);</span><br><span class="line">Â Â <span class="built_in">Transform</span>(<span class="keyword">static_cast</span>&lt;Dst&gt;(s));</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></article><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-62b11572b25ab3ab" async="async"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/01/12/Lecture/%E4%BB%8E%E5%89%8D%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/OOP/L4%20%E5%88%9B%E5%BB%BA%E4%B8%8E%E9%94%80%E6%AF%81%C2%B7%E4%B8%80/"><img class="prev-cover" src="https://raw.githubusercontent.com/zhaochenyang20/ivue_wallpaper/main/ivue_desktop/Photo by Jon Flobrant (JU2MgHOHDsw).jpg" onerror="onerror=null;src='https://raw.githubusercontent.com/zhaochenyang20/ivue_wallpaper/main/ivue_desktop/Photo by Oscar Rodrigo Hernandez Panczenko (P0GQ95huhBo).jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">oopç¬”è®°  L4  åˆ›å»ºä¸é”€æ¯Â·ä¸€</div></div></a></div><div class="next-post pull-right"><a href="/2022/01/12/Lecture/%E4%BB%8E%E5%89%8D%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/OOP/L7%20%E7%BB%84%E5%90%88%E4%B8%8E%E7%BB%A7%E6%89%BF/"><img class="next-cover" src="https://raw.githubusercontent.com/zhaochenyang20/ivue_wallpaper/main/ivue_desktop/Photo by Roberto Nickson (7BjmDICVloE).jpg" onerror="onerror=null;src='https://raw.githubusercontent.com/zhaochenyang20/ivue_wallpaper/main/ivue_desktop/Photo by Oscar Rodrigo Hernandez Panczenko (P0GQ95huhBo).jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">oopç¬”è®°  L7  ç»„åˆä¸ç»§æ‰¿</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#L6-%E5%BC%95%E7%94%A8%E4%B8%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">1.</span> <span class="toc-text">L6 å¼•ç”¨ä¸å¤åˆ¶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%B8%B8%E9%87%8F%E5%BC%95%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">ä¸€ã€å¸¸é‡å¼•ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%B8%B8%E9%87%8F%E5%BC%95%E7%94%A8%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-number">2.1.</span> <span class="toc-text">1.1  å¸¸é‡å¼•ç”¨çš„æ„ä¹‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">äºŒã€æ‹·è´æ„é€ å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%AE%9A%E4%B9%89%E4%B8%8E%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99"><span class="toc-number">3.1.</span> <span class="toc-text">2.1  å®šä¹‰ä¸è¯­æ³•è§„åˆ™</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E8%B0%83%E7%94%A8%E6%97%B6%E6%9C%BA"><span class="toc-number">3.2.</span> <span class="toc-text">2.2  è°ƒç”¨æ—¶æœº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E9%9A%90%E5%BC%8F%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">3.3.</span> <span class="toc-text">2.3  éšå¼æ‹·è´æ„é€ å‡½æ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">3.4.</span> <span class="toc-text">2.4  æ‰§è¡Œé¡ºåº</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-1-%E5%9F%BA%E6%9C%AC%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">3.4.1.</span> <span class="toc-text">2.4.1  åŸºæœ¬çš„æ‰§è¡Œé¡ºåº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-2-%E4%BE%8B%E5%AD%90"><span class="toc-number">3.4.2.</span> <span class="toc-text">2.4.2  ä¾‹å­</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E7%BC%BA%E9%99%B7"><span class="toc-number">3.5.</span> <span class="toc-text">2.5  æ‹·è´æ„é€ å‡½æ•°çš„ç¼ºé™·</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95"><span class="toc-number">3.6.</span> <span class="toc-text">2.6  è§£å†³æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%A7%BB%E5%8A%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">ä¸‰ã€ç§»åŠ¨æ„é€ å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E5%8F%B3%E5%80%BC%E4%B8%8E%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8"><span class="toc-number">4.1.</span> <span class="toc-text">3.1  å³å€¼ä¸å³å€¼å¼•ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-%E5%B7%A6%E5%8F%B3%E5%80%BC"><span class="toc-number">4.1.1.</span> <span class="toc-text">3.1.1  å·¦å³å€¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8"><span class="toc-number">4.1.2.</span> <span class="toc-text">3.1.2  å³å€¼å¼•ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E7%A7%BB%E5%8A%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.</span> <span class="toc-text">3.2  ç§»åŠ¨æ„é€ å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-%E5%AE%9A%E4%B9%89%E4%B8%8E%E6%84%8F%E4%B9%89"><span class="toc-number">4.2.1.</span> <span class="toc-text">3.2.1  å®šä¹‰ä¸æ„ä¹‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E4%B8%A4%E7%A7%8D%E6%9E%84%E9%80%A0%E6%9C%AC%E8%B4%A8%E5%8C%BA%E5%88%AB"><span class="toc-number">4.2.2.</span> <span class="toc-text">3.2.2  ä¸¤ç§æ„é€ æœ¬è´¨åŒºåˆ«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3-%E4%BE%8B%E5%AD%90"><span class="toc-number">4.2.3.</span> <span class="toc-text">3.2.3  ä¾‹å­</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E7%A7%BB%E5%8A%A8%E8%AF%AD%E5%8F%A5"><span class="toc-number">4.3.</span> <span class="toc-text">3.3  ç§»åŠ¨è¯­å¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-1-%E8%AF%AD%E6%B3%95%E4%B8%8E%E6%84%8F%E4%B9%89"><span class="toc-number">4.3.1.</span> <span class="toc-text">3.3.1  è¯­æ³•ä¸æ„ä¹‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-2-%E4%BE%8B%E5%AD%90"><span class="toc-number">4.3.2.</span> <span class="toc-text">3.3.2  ä¾‹å­</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E4%B8%A4%E7%B1%BB%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E8%B0%83%E7%94%A8%E6%97%B6%E6%9C%BA"><span class="toc-number">4.4.</span> <span class="toc-text">3.4  ä¸¤ç±»æ„é€ å‡½æ•°çš„è°ƒç”¨æ—¶æœº</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-1-%E5%88%A4%E6%96%AD%E4%BE%9D%E6%8D%AE"><span class="toc-number">4.4.1.</span> <span class="toc-text">3.4.1  åˆ¤æ–­ä¾æ®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-2-%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E5%B8%B8%E8%A7%81%E8%B0%83%E7%94%A8%E6%97%B6%E6%9C%BA"><span class="toc-number">4.4.2.</span> <span class="toc-text">3.4.2  æ‹·è´æ„é€ å‡½æ•°çš„å¸¸è§è°ƒç”¨æ—¶æœº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-3-%E7%A7%BB%E5%8A%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E5%B8%B8%E8%A7%81%E8%B0%83%E7%94%A8%E6%97%B6%E6%9C%BA"><span class="toc-number">4.4.3.</span> <span class="toc-text">3.4.3  ç§»åŠ¨æ„é€ å‡½æ•°çš„å¸¸è§è°ƒç”¨æ—¶æœº</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%8B%B7%E8%B4%9D%E4%B8%8E%E7%A7%BB%E5%8A%A8%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">5.</span> <span class="toc-text">å››ã€æ‹·è´ä¸ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E6%8B%B7%E8%B4%9D%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6%E5%AE%9A%E4%B9%89%E4%B8%8E%E6%84%8F%E4%B9%89"><span class="toc-number">5.1.</span> <span class="toc-text">4.1  æ‹·è´èµ‹å€¼è¿ç®—ç¬¦å®šä¹‰ä¸æ„ä¹‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E7%A7%BB%E5%8A%A8%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BD%9C%E7%94%A8%E4%B8%8E%E6%84%8F%E4%B9%89"><span class="toc-number">5.2.</span> <span class="toc-text">4.2  ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ä½œç”¨ä¸æ„ä¹‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E8%B0%83%E7%94%A8%E6%97%B6%E6%9C%BA"><span class="toc-number">5.3.</span> <span class="toc-text">4.3  è°ƒç”¨æ—¶æœº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-%E8%87%AA%E5%8A%A8%E5%90%88%E6%88%90%E7%9A%84%E5%87%BD%E6%95%B0%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">5.4.</span> <span class="toc-text">4.4  è‡ªåŠ¨åˆæˆçš„å‡½æ•°ä¸è¿ç®—ç¬¦</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC%E4%BC%98%E5%8C%96"><span class="toc-number">6.</span> <span class="toc-text">äº”ã€è¿”å›å€¼ä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E4%BC%98%E5%8C%96%E6%9D%A1%E4%BB%B6"><span class="toc-number">6.1.</span> <span class="toc-text">5.1  ä¼˜åŒ–æ¡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E4%BC%98%E5%8C%96%E6%84%8F%E4%B9%89"><span class="toc-number">6.2.</span> <span class="toc-text">5.2  ä¼˜åŒ–æ„ä¹‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E4%BC%98%E5%8C%96%E5%AE%9E%E4%BE%8B"><span class="toc-number">6.3.</span> <span class="toc-text">5.3  ä¼˜åŒ–å®ä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-%E8%BF%94%E5%9B%9E%E5%80%BC%E6%9E%84%E9%80%A0"><span class="toc-number">6.4.</span> <span class="toc-text">5.4  è¿”å›å€¼æ„é€ </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-%E4%BE%8B%E5%AD%90"><span class="toc-number">6.5.</span> <span class="toc-text">5.5  ä¾‹å­</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81delete-%E4%B8%8E%E6%A3%80%E6%B5%8B"><span class="toc-number">7.</span> <span class="toc-text">å…­ã€delete ä¸æ£€æµ‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-Delete-%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-number">7.1.</span> <span class="toc-text">6.1  Delete çš„æ„ä¹‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-Delete%E7%9A%84%E6%A3%80%E6%B5%8B"><span class="toc-number">7.2.</span> <span class="toc-text">6.2  Deleteçš„æ£€æµ‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E8%B5%8B%E5%80%BC%E7%9A%84%E6%A3%80%E6%B5%8B"><span class="toc-number">7.3.</span> <span class="toc-text">6.3  èµ‹å€¼çš„æ£€æµ‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81move-%E4%B8%8E%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">8.</span> <span class="toc-text">ä¸ƒã€move ä¸ç±»å‹è½¬æ¢</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-move-%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-number">8.1.</span> <span class="toc-text">7.1  move çš„æ„ä¹‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E4%BE%8B%E5%AD%90"><span class="toc-number">8.2.</span> <span class="toc-text">7.2  ä¾‹å­</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E8%BF%9B%E4%B8%80%E6%AD%A5%E8%AE%A8%E8%AE%BA"><span class="toc-number">8.3.</span> <span class="toc-text">7.3  è¿›ä¸€æ­¥è®¨è®º</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E7%BD%AE%E7%A9%BA%E6%80%A7%E8%AE%A8%E8%AE%BA"><span class="toc-number">9.</span> <span class="toc-text">å…«ã€ç½®ç©ºæ€§è®¨è®º</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-0-%E6%9E%90%E6%9E%84%E7%BD%AE%E7%A9%BA"><span class="toc-number">9.1.</span> <span class="toc-text">8.0  ææ„ç½®ç©º</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-%E7%A7%BB%E5%8A%A8%E7%BD%AE%E7%A9%BA"><span class="toc-number">9.2.</span> <span class="toc-text">8.1  ç§»åŠ¨ç½®ç©º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-1-%E7%A7%BB%E5%8A%A8%E5%92%8C%E6%8B%B7%E8%B4%9D%E7%9A%84%E8%AF%AD%E4%B9%89%E5%8C%BA%E5%88%AB"><span class="toc-number">9.2.1.</span> <span class="toc-text">8.1.1  ç§»åŠ¨å’Œæ‹·è´çš„è¯­ä¹‰åŒºåˆ«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-2-%E7%A7%BB%E5%8A%A8%E5%92%8C%E6%8B%B7%E8%B4%9D%E7%9A%84%E5%8E%9F%E7%90%86%E5%8C%BA%E5%88%AB"><span class="toc-number">9.2.2.</span> <span class="toc-text">8.1.2 ç§»åŠ¨å’Œæ‹·è´çš„åŸç†åŒºåˆ«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-3-%E7%A7%BB%E5%8A%A8%E8%BF%87%E7%A8%8B%E4%B8%ADB%E6%8C%87%E9%92%88%E7%BD%AE%E7%A9%BA"><span class="toc-number">9.2.3.</span> <span class="toc-text">8.1.3  ç§»åŠ¨è¿‡ç¨‹ä¸­BæŒ‡é’ˆç½®ç©º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-4-%E7%A7%BB%E5%8A%A8%E8%BF%87%E7%A8%8B%E4%B8%ADB%E5%AE%8C%E5%85%A8%E7%BD%AE%E7%A9%BA"><span class="toc-number">9.2.4.</span> <span class="toc-text">8.1.4 ç§»åŠ¨è¿‡ç¨‹ä¸­Bå®Œå…¨ç½®ç©º</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-%E8%B5%8B%E5%80%BC%E7%BD%AE%E7%A9%BA"><span class="toc-number">9.3.</span> <span class="toc-text">8.2  èµ‹å€¼ç½®ç©º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-1-%E6%8B%B7%E8%B4%9D%E8%B5%8B%E5%80%BC"><span class="toc-number">9.3.1.</span> <span class="toc-text">8.2.1  æ‹·è´èµ‹å€¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-2-%E7%A7%BB%E5%8A%A8%E8%B5%8B%E5%80%BC"><span class="toc-number">9.3.2.</span> <span class="toc-text">8.2.2  ç§»åŠ¨èµ‹å€¼</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">10.</span> <span class="toc-text">ä¹ã€ç±»å‹è½¬æ¢</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-%E6%84%8F%E4%B9%89"><span class="toc-number">10.1.</span> <span class="toc-text">9.1  æ„ä¹‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-%E8%AF%AD%E6%B3%95"><span class="toc-number">10.2.</span> <span class="toc-text">9.2  è¯­æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-%E4%BE%8B%E5%AD%90"><span class="toc-number">10.3.</span> <span class="toc-text">9.3  ä¾‹å­</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4-%E7%A6%81%E6%AD%A2%E8%87%AA%E5%8A%A8%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">10.4.</span> <span class="toc-text">9.4  ç¦æ­¢è‡ªåŠ¨ç±»å‹è½¬æ¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5-%E5%9B%9B%E7%B1%BB%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">10.5.</span> <span class="toc-text">9.5  å››ç±»å¼ºåˆ¶ç±»å‹è½¬æ¢</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background: ï¼ƒ0096FF"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Eren Zhao</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div><script type="text/javascript" id="maid-script" src="https://unpkg.com/mermaid@undefined/dist/mermaid.min.js?v=undefined"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize(options);
}</script></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœ¬åœ°æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“æ­£åœ¨è‰°éš¾è¿è¡Œ</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '978121c7b834efdd76be',
      clientSecret: '59b40e8f39a1c33db5a2c891771086164b9575c4',
      repo: 'zhaochenyang20.github.io',
      owner: 'zhaochenyang20',
      admin: ['zhaochenyang20'],
      id: '5671b1b61ec5f12f246df4bedc21ca59',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script></body></html>