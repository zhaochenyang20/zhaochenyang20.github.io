document.addEventListener("DOMContentLoaded",()=>{let c=window.CONFIG,d=window.CONFIG.local_search.path;if(!d){console.warn("`hexo-generator-searchdb` plugin is not installed!");return}let t=new LocalSearch({path:d,top_n_per_article:c.localsearch.top_n_per_article,unescape:c.localsearch.unescape}),i=document.querySelector(".search-input"),o=()=>{if(!t.isfetched)return;let s=i.value.trim().toLowerCase(),l=s.split(/[-\s]+/),n=document.querySelector(".search-result-container"),a=[];if(s.length>0&&(a=t.getResultItems(l)),l.length===1&&l[0]==="")n.classList.add("no-result"),n.innerHTML='<div class="search-result-icon"><i class="fa fa-search fa-5x"></i></div>';else if(a.length===0)n.classList.add("no-result"),n.innerHTML='<div class="search-result-icon"><i class="far fa-frown fa-5x"></i></div>';else{a.sort((e,r)=>e.includedCount!==r.includedCount?r.includedCount-e.includedCount:e.hitCount!==r.hitCount?r.hitCount-e.hitCount:r.id-e.id);let u=c.i18n.hits.replace(/\$\{hits}/,a.length);n.classList.remove("no-result"),n.innerHTML=`<div class="search-stats">${u}</div>
        <hr>
        <ul class="search-result-list">${a.map(e=>e.item).join("")}</ul>`}};t.highlightSearchWords(document.querySelector(".post-body")),c.localsearch.preload&&t.fetchData(),c.localsearch.trigger==="auto"?i.addEventListener("input",o):(document.querySelector(".search-icon").addEventListener("click",o),i.addEventListener("keypress",s=>{s.key==="Enter"&&o()})),window.addEventListener("search:loaded",o),document.querySelectorAll(".popup-trigger").forEach(s=>{s.addEventListener("click",()=>{document.body.classList.add("search-active"),setTimeout(()=>i.focus(),500),t.isfetched||t.fetchData()})})});
